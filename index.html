<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø§Ø­Ø¬Ø²Ù„ÙŠ - Ø­Ø¬Ø² Ù…Ù„Ø§Ø¹Ø¨ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…</title>
  
  <!-- Meta Tags for SEO & Security -->
  <meta name="description" content="Ù…Ù„Ø¹Ø¨Ùƒ ÙÙŠ Ø¶ØºØ·Ø©ØŒ ÙˆØ­Ø¬Ø²Ùƒ Ù…Ø¤ÙƒØ¯ Ø¹Ù†Ø¯Ù†Ø§ - Ø§Ø­Ø¬Ø² Ù…Ù„Ø§Ø¹Ø¨ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… Ø¨Ø³Ù‡ÙˆÙ„Ø© Ù…Ø¹ Ø§Ø­Ø¬Ø²Ù„ÙŠ. Ø¯ÙØ¹ Ø¹Ø±Ø¨ÙˆÙ†ØŒ Ø·Ù„Ø¨ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¥Ø¶Ø§ÙÙŠÙŠÙ†ØŒ Ø£ÙƒÙˆØ§Ø¯ Ø¯ÙØ¹">
  <meta name="theme-color" content="#1a7f46">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://cdn.jsdelivr.net https://fonts.googleapis.com https://fonts.gstatic.com https://placehold.co; script-src 'self' https://cdn.jsdelivr.net; style-src 'self' https://cdn.jsdelivr.net https://fonts.googleapis.com 'unsafe-inline';">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="icon" href="./images/favicon.png">
  
  <!-- Bootstrap + Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --primary-color: #1a7f46;
      --secondary-color: #2ecc71;
      --accent-color: #f39c12;
      --dark-color: #2c3e50;
      --light-color: #ecf0f1;
      --blue-color: #3498db;
      --gold-color: #ffd700;
      
      /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ */
      --night-bg: #0a1929;
      --night-card: #132f4c;
      --night-text: #e0e0e0;
      --night-border: #1e4976;
      --night-primary: #1976d2;
    }
    
    body {
      font-family: 'Cairo', sans-serif;
      background-color: #f8f9fa;
      color: #333;
      overflow-x: hidden;
      transition: all 0.3s ease;
    }

    /* Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ */
    body.night-mode {
      background-color: var(--night-bg);
      color: var(--night-text);
    }

    .night-mode .navbar {
      background: rgba(19, 47, 76, 0.95) !important;
    }

    .night-mode .navbar-brand,
    .night-mode .nav-link {
      color: var(--night-text) !important;
    }

    .night-mode .stadium-card,
    .night-mode .feature-card,
    .night-mode .area-card,
    .night-mode .banner-content {
      background: var(--night-card);
      color: var(--night-text);
      border: 1px solid var(--night-border);
    }

    .night-mode .footer {
      background: var(--night-card) !important;
    }

    .night-mode .form-control,
    .night-mode .form-select {
      background: var(--night-card);
      color: var(--night-text);
      border-color: var(--night-border);
    }

    .night-mode .section-title {
      color: var(--night-text);
    }

    .night-mode .features-section,
    .night-mode .areas-section,
    .night-mode .how-it-works {
      background: var(--night-bg);
    }

    .night-mode .featured-stadiums {
      background: linear-gradient(135deg, var(--night-bg), var(--night-card));
    }

    /* Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ */
    .theme-toggle {
      position: fixed;
      top: 100px;
      left: 30px;
      width: 50px;
      height: 50px;
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 50%;
      font-size: 1.2rem;
      cursor: pointer;
      z-index: 1000;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .theme-toggle:hover {
      background: var(--secondary-color);
      transform: translateY(-3px);
    }

    .night-mode .theme-toggle {
      background: var(--night-primary);
    }

    /* ğŸ†• Ø¥Ø¶Ø§ÙØ§Øª Ø¬Ø¯ÙŠØ¯Ø© */
    
    /* Ø´Ø§Ø±Ø© Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© */
    .golden-slot-badge {
      background: linear-gradient(135deg, #ffd700, #ffed4e) !important;
      color: #000 !important;
      font-weight: bold;
      border: 2px solid #ffc107;
    }
    
    /* Ø²Ø± Ø·Ù„Ø¨ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† */
    .players-request-btn {
      background: linear-gradient(135deg, #ffd700, #ffed4e);
      color: #000;
      border: none;
      font-weight: 600;
    }
    
    .players-request-btn:hover {
      background: linear-gradient(135deg, #ffed4e, #ffd700);
      transform: translateY(-2px);
    }
    
    /* Ø¹Ø¯ ØªÙ†Ø§Ø²Ù„ÙŠ Ù„Ù„Ø­Ø¬Ø² */
    .countdown-timer {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 25px;
      font-weight: bold;
      font-size: 0.9rem;
    }
    
    /* Ù†Ø¸Ø§Ù… Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ ÙÙŠ Ø§Ù„Ø¯ÙØ¹ */
    .voucher-section {
      border: 2px dashed #1a7f46;
      border-radius: 10px;
      padding: 1rem;
      background: #f8fff9;
      margin: 1rem 0;
    }
    
    .night-mode .voucher-section {
      border-color: var(--night-primary);
      background: rgba(25, 118, 210, 0.1);
    }
    
    .voucher-input-group {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }
    
    .voucher-input {
      flex: 1;
    }

    /* ğŸ†• Ø´Ø±ÙŠØ· Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø© ÙÙŠ Ø§Ù„ÙÙˆØªØ± */
    .features-bar {
      background: linear-gradient(135deg, #1a7f46, #2ecc71);
      color: white;
      padding: 2rem 0;
    }
    
    .feature-item {
      text-align: center;
      padding: 1rem;
    }
    
    .feature-icon {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      color: var(--accent-color);
    }
    
    .feature-text {
      font-size: 0.9rem;
      font-weight: 500;
    }

    /* ğŸ†• Ù‚Ø³Ù… ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ */
    .how-it-works {
      padding: 4rem 0;
      background: #f8f9fa;
    }
    
    .step-card {
      text-align: center;
      padding: 2rem 1rem;
    }
    
    .step-number {
      width: 60px;
      height: 60px;
      background: var(--primary-color);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      font-weight: bold;
      margin: 0 auto 1rem;
    }
    
    /* ğŸ†• Ù‚Ø³Ù… Ø§Ù„Ø¨Ø§Ù†Ø±Ø² ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ */
    .banners-section {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 2rem 0;
    }
    
    .banner-card {
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
      height: 100%;
    }
    
    .banner-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0,0,0,0.3);
    }
    
    .banner-image {
      height: 200px;
      background-size: cover;
      background-position: center;
      position: relative;
    }
    
    .banner-content {
      padding: 1.5rem;
      background: white;
    }
    
    .banner-badge {
      position: absolute;
      top: 15px;
      left: 15px;
      background: var(--accent-color);
      color: #000;
      padding: 0.5rem 1rem;
      border-radius: 25px;
      font-weight: bold;
      font-size: 0.9rem;
    }

    /* ğŸ†• Ø´Ø§Ø±Ø© Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ù…ØªØ§Ø­Ø© */
    .next-slot-badge {
      background: linear-gradient(135deg, #1a7f46, #2ecc71);
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }

    /* ğŸ†• ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø¨Ø­Ø« */
    .search-box {
      position: relative;
    }
    
    .search-box .form-control {
      padding-right: 3rem;
      border-radius: 25px;
    }
    
    .search-icon {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      color: #666;
    }

    /* ğŸ†• Ù‚Ø³Ù… Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…Ù…ÙŠØ²Ø© */
    .featured-stadiums {
      background: linear-gradient(135deg, #f8f9fa, #e9ecef);
      padding: 4rem 0;
    }
    
    .featured-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      background: linear-gradient(135deg, #ff6b6b, #ffa500);
      color: white;
      padding: 0.3rem 0.8rem;
      border-radius: 15px;
      font-size: 0.8rem;
      font-weight: 600;
      z-index: 2;
    }

    /* ğŸ†• Ø²Ø± Ø§Ù„Ù…ÙØ¶Ù„Ø© */
    .favorite-btn {
      transition: all 0.3s ease;
    }
    
    .favorite-btn:hover {
      transform: scale(1.1);
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© */
    .time-slot.golden {
      background: linear-gradient(135deg, #fff9e6, #fff3cd);
      border: 2px solid var(--gold-color);
      color: #000;
      font-weight: bold;
    }
    
    .time-slot.golden::before {
      content: 'ğŸ‘¥';
      margin-left: 5px;
    }

    /* Loading Screen - Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
    #loadingOverlay {
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      background: linear-gradient(135deg, #1a7f46, #2ecc71);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.4s ease;
    }
    
    .night-mode #loadingOverlay {
      background: linear-gradient(135deg, var(--night-primary), #0a1929);
    }
    
    #loadingOverlay.fade-out {
      opacity: 0;
      visibility: hidden;
    }
    
    /* ğŸ†• Spinner Ø§Ù„Ø¬Ø¯ÙŠØ¯ - 5 Ø£Ù†ØµØ§Ù Ø¯ÙˆØ§Ø¦Ø± Ø¨Ø£Ù‚Ø·Ø§Ø± ÙˆØ£Ù„ÙˆØ§Ù† Ù…Ø®ØªÙ„ÙØ© */
    .multi-circle-spinner {
      position: relative;
      width: 150px;
      height: 150px;
    }
    
    .circle {
      position: absolute;
      border: 4px solid transparent;
      border-top: 4px solid var(--blue-color);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    
    .circle:nth-child(1) {
      width: 120px;
      height: 120px;
      top: 15px;
      left: 15px;
      border-top-color: #1e40af;
      animation-delay: 0s;
    }
    
    .circle:nth-child(2) {
      width: 100px;
      height: 100px;
      top: 25px;
      left: 25px;
      border-top-color: #3b82f6;
      animation-delay: 0.1s;
      animation-duration: 0.9s;
    }
    
    .circle:nth-child(3) {
      width: 80px;
      height: 80px;
      top: 35px;
      left: 35px;
      border-top-color: #60a5fa;
      animation-delay: 0.2s;
      animation-duration: 1s;
    }
    
    .circle:nth-child(4) {
      width: 60px;
      height: 60px;
      top: 45px;
      left: 45px;
      border-top-color: #93c5fd;
      animation-delay: 0.3s;
      animation-duration: 1.1s;
    }
    
    .circle:nth-child(5) {
      width: 40px;
      height: 40px;
      top: 55px;
      left: 55px;
      border-top-color: #bfdbfe;
      animation-delay: 0.4s;
      animation-duration: 1.2s;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .loading-text {
      position: absolute;
      bottom: -50px;
      right: 0;
      left: 0;
      text-align: center;
      color: white;
      font-weight: 600;
      font-size: 1.2rem;
    }

    /* ğŸ†• Ø´Ø±ÙŠØ· Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø­Ø¬Ø² */
    .booking-tracker {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 1rem;
      border-radius: 10px;
      margin-bottom: 2rem;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      display: none;
      position: sticky;
      top: 80px;
      z-index: 1000;
    }
    
    .tracker-progress {
      height: 8px;
      background: rgba(255,255,255,0.3);
      border-radius: 4px;
      overflow: hidden;
      margin: 10px 0;
    }
    
    .tracker-progress-bar {
      height: 100%;
      background: #fff;
      border-radius: 4px;
      transition: width 0.3s ease;
    }
    
    /* Navigation */
    .navbar {
      background: rgba(255, 255, 255, 0.95) !important;
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 20px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
    }
    
    .navbar.scrolled {
      background: rgba(255, 255, 255, 0.98) !important;
      padding: 0.5rem 0;
    }
    
    .navbar-brand {
      font-weight: 700;
      color: var(--primary-color) !important;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
    }
    
    .logo-img {
      height: 40px;
      margin-left: 10px;
    }
    
    .nav-link {
      font-weight: 500;
      margin: 0 0.5rem;
      color: var(--dark-color) !important;
      transition: color 0.3s ease;
    }
    
    .nav-link:hover, .nav-link.active {
      color: var(--primary-color) !important;
    }
    
    /* Hero Section Ù…Ø¹ ØµÙˆØ±Ø© Ø§Ù„Ù†Ø¬ÙŠÙ„Ø© */
    .hero-section {
      background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), 
                  url('https://plus.unsplash.com/premium_photo-1684713510655-e6e31536168d?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=870') center/cover no-repeat;
      min-height: 80vh;
      display: flex;
      align-items: center;
      color: white;
      position: relative;
      margin-top: 76px;
    }
    
    .hero-content {
      text-align: center;
    }
    
    .hero-title {
      font-size: 3.5rem;
      font-weight: 700;
      margin-bottom: 1rem;
      text-shadow: 2px 2px 8px rgba(0,0,0,0.5);
    }
    
    .hero-subtitle {
      font-size: 1.3rem;
      margin-bottom: 2rem;
      opacity: 0.9;
      line-height: 1.6;
    }
    
    .hero-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    /* Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø­Ø¬Ø² */
    .areas-section {
      padding: 4rem 0;
      background: white;
    }
    
    .area-card {
      border: none;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      margin-bottom: 2rem;
      text-align: center;
    }
    
    .area-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    }
    
    .area-image {
      height: 200px;
      background-size: cover;
      background-position: center;
      position: relative;
    }
    
    .area-title {
      padding: 1.5rem;
      font-size: 1.3rem;
      font-weight: 600;
      color: var(--dark-color);
    }
    
    .night-mode .area-title {
      color: var(--night-text);
    }
    
    /* ğŸ†• ØªØ­Ø³ÙŠÙ† Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ */
    .stadium-card {
      border: none;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      margin-bottom: 2rem;
      position: relative;
    }
    
    .stadium-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    }
    
    .stadium-image {
      height: 200px;
      background-size: cover;
      background-position: center;
      position: relative;
    }
    
    .stadium-badge {
      position: absolute;
      top: 15px;
      left: 15px;
      background: var(--primary-color);
      color: white;
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
    }
    
    .availability-low {
      background: #e74c3c;
    }
    
    .availability-medium {
      background: #f39c12;
    }
    
    .availability-high {
      background: #27ae60;
    }
    
    .stadium-price {
      position: absolute;
      bottom: 15px;
      left: 15px;
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 25px;
      font-weight: 600;
    }
    
    .stadium-deposit {
      position: absolute;
      bottom: 15px;
      right: 15px;
      background: rgba(52, 152, 219, 0.9);
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 25px;
      font-weight: 600;
    }
    
    .stadium-info {
      padding: 1.5rem;
    }
    
    .stadium-title {
      font-size: 1.3rem;
      font-weight: 600;
      color: var(--dark-color);
      margin-bottom: 0.5rem;
    }
    
    .night-mode .stadium-title {
      color: var(--night-text);
    }
    
    .stadium-location {
      color: #666;
      margin-bottom: 1rem;
    }
    
    .night-mode .stadium-location {
      color: #b0b0b0;
    }
    
    .stadium-features {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    
    .feature {
      display: flex;
      align-items: center;
      gap: 0.3rem;
      font-size: 0.8rem;
      color: #666;
      background: #f8f9fa;
      padding: 0.3rem 0.6rem;
      border-radius: 12px;
    }
    
    .night-mode .feature {
      background: var(--night-border);
      color: var(--night-text);
    }
    
    .feature i {
      color: var(--primary-color);
    }
    
    /* ğŸ†• ØªØ­Ø³ÙŠÙ† Ù…Ø¸Ù‡Ø± Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£ÙŠØ§Ù… */
    .days-selector {
      margin-bottom: 1rem;
    }
    
    .day-select {
      border-radius: 10px;
      padding: 0.75rem;
      border: 2px solid #e9ecef;
      transition: all 0.3s ease;
    }
    
    .day-select:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 0.2rem rgba(26, 127, 70, 0.25);
    }
    
    /* ğŸ†• Time Slots Ø§Ù„Ù…Ø­Ø³Ù†Ø© */
    .time-slots-container {
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid #e9ecef;
      border-radius: 10px;
      padding: 1rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    
    .time-slot {
      flex: 1;
      min-width: 100px;
      padding: 0.8rem 0.5rem;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      background: white;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
      font-size: 0.9rem;
    }
    
    .night-mode .time-slot {
      background: var(--night-card);
      border-color: var(--night-border);
      color: var(--night-text);
    }
    
    .time-slot.available {
      border-color: var(--primary-color);
      background: rgba(26, 127, 70, 0.05);
    }
    
    .time-slot.available:hover {
      background: var(--primary-color);
      color: white;
    }
    
    .time-slot.booked {
      background: #e74c3c;
      color: white;
      border-color: #e74c3c;
      cursor: not-allowed;
      opacity: 0.7;
    }
    
    .time-slot.selected {
      background: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }
    
    /* Rating Stars */
    .rating-stars {
      display: flex;
      gap: 2px;
      margin-bottom: 5px;
    }
    
    .star {
      color: #ddd;
      cursor: pointer;
      transition: color 0.2s ease;
    }
    
    .star.active {
      color: #f39c12;
    }
    
    .star:hover {
      color: #f39c12;
    }
    
    .rating-text {
      font-size: 0.9rem;
      color: #666;
    }
    
    .night-mode .rating-text {
      color: #b0b0b0;
    }
    
    /* Buttons */
    .btn-primary {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      border: none;
      padding: 0.8rem 2rem;
      font-weight: 600;
      border-radius: 25px;
      transition: all 0.3s ease;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(26, 127, 70, 0.3);
    }
    
    .btn-outline-primary {
      border: 2px solid var(--primary-color);
      color: var(--primary-color);
      padding: 0.6rem 1.5rem;
      font-weight: 600;
      border-radius: 25px;
      transition: all 0.3s ease;
    }
    
    .btn-outline-primary:hover {
      background: var(--primary-color);
      color: white;
    }
    
    /* Sections */
    .section-title {
      font-size: 2.5rem;
      font-weight: 700;
      text-align: center;
      margin-bottom: 3rem;
      color: var(--dark-color);
      position: relative;
    }
    
    .section-title::after {
      content: '';
      position: absolute;
      bottom: -10px;
      right: 50%;
      transform: translateX(50%);
      width: 80px;
      height: 4px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      border-radius: 2px;
    }
    
    /* Features Section */
    .features-section {
      padding: 5rem 0;
      background: white;
    }
    
    .feature-card {
      text-align: center;
      padding: 2rem 1rem;
      border-radius: 15px;
      transition: all 0.3s ease;
      border: 1px solid #f0f0f0;
    }
    
    .feature-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    
    .feature-icon {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 1.5rem;
    }
    
    .feature-icon i {
      font-size: 2rem;
      color: white;
    }
    
    /* Footer */
    .footer {
      background: var(--dark-color);
      color: white;
      padding: 3rem 0 1rem;
    }
    
    .footer h5 {
      color: var(--secondary-color);
      margin-bottom: 1.5rem;
    }
    
    .footer-links a {
      color: #bdc3c7;
      text-decoration: none;
      display: block;
      margin-bottom: 0.5rem;
      transition: color 0.3s ease;
    }
    
    .footer-links a:hover {
      color: var(--secondary-color);
    }
    
    .social-links {
      display: flex;
      gap: 1rem;
    }
    
    .social-links a {
      width: 40px;
      height: 40px;
      background: rgba(255,255,255,0.1);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      text-decoration: none;
      transition: all 0.3s ease;
    }
    
    .social-links a:hover {
      background: var(--primary-color);
      transform: translateY(-3px);
    }
    
    /* ğŸ†• Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø² Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ø®Ø·ÙˆØ§Øª */
    .cancellation-step {
      display: none;
    }
    
    .cancellation-step.active {
      display: block;
    }

    /* ğŸ†• ØªØ£Ø«ÙŠØ±Ø§Øª Ø¸Ù‡ÙˆØ± Ø§Ù„Ø¹Ù†Ø§ØµØ± */
    .fade-in {
      animation: fadeIn 1s ease-in-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ğŸ†• ØªØ¸Ù„ÙŠÙ„ Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ */
    .text-light {
      text-shadow: 0 0 5px rgba(0,0,0,0.4);
    }

    /* ğŸ†• Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø£Ø¹Ù„Ù‰ */
    #toTop {
      position: fixed;
      bottom: 30px;
      left: 30px;
      width: 50px;
      height: 50px;
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 50%;
      font-size: 1.2rem;
      cursor: pointer;
      display: none;
      z-index: 1000;
      transition: all 0.3s ease;
    }
    
    #toTop:hover {
      background: var(--secondary-color);
      transform: translateY(-3px);
    }

    .night-mode #toTop {
      background: var(--night-primary);
    }

    /* ğŸ†• Toast notifications */
    .toast {
      position: fixed;
      top: 100px;
      right: 20px;
      background: var(--primary-color);
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 9999;
      animation: slideIn 0.3s ease;
    }
    
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    
    /* Ø­Ø§Ù„Ø© ÙØ§Ø±ØºØ© */
    .empty-state {
      text-align: center;
      padding: 3rem 1rem;
      color: #666;
    }
    
    .empty-state i {
      font-size: 3rem;
      color: #ddd;
      margin-bottom: 1rem;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .hero-title {
        font-size: 2.5rem;
      }
      
      .section-title {
        font-size: 2rem;
      }
      
      .time-slot {
        min-width: 80px;
        font-size: 0.8rem;
        padding: 0.6rem 0.4rem;
      }
      
      .booking-tracker {
        position: relative;
        top: 0;
      }
      
      .multi-circle-spinner {
        width: 120px;
        height: 120px;
      }
      
      .circle:nth-child(1) {
        width: 100px;
        height: 100px;
        top: 10px;
        left: 10px;
      }
      
      .circle:nth-child(2) {
        width: 80px;
        height: 80px;
        top: 20px;
        left: 20px;
      }
      
      .circle:nth-child(3) {
        width: 60px;
        height: 60px;
        top: 30px;
        left: 30px;
      }
      
      .circle:nth-child(4) {
        width: 40px;
        height: 40px;
        top: 40px;
        left: 40px;
      }
      
      .circle:nth-child(5) {
        width: 20px;
        height: 20px;
        top: 50px;
        left: 50px;
      }
      
      #toTop, .theme-toggle {
        left: 20px;
        bottom: 20px;
        width: 45px;
        height: 45px;
      }
      
      .theme-toggle {
        top: 90px;
      }
      
      .hero-buttons {
        flex-direction: column;
        align-items: center;
      }
      
      .hero-buttons .btn {
        width: 100%;
        max-width: 300px;
      }
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„ÙŠØ© */
    .time-slot[role="button"]:focus {
      outline: 2px solid var(--primary-color);
      outline-offset: 2px;
    }

    .modal {
      --bs-modal-zindex: 1055;
    }

    .modal[role="dialog"] {
      z-index: var(--bs-modal-zindex);
    }
  </style>
</head>
<body>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø·ÙˆØ±Ø© -->
<div id="loadingOverlay">
  <div class="multi-circle-spinner">
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="loading-text">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
  </div>
</div>

<!-- ğŸ†• Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø£Ø¹Ù„Ù‰ -->
<button id="toTop" title="Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø£Ø¹Ù„Ù‰">â¬†</button>

<!-- ğŸ†• Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ -->
<button class="theme-toggle" id="themeToggle" title="Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ">
  <i class="bi bi-moon"></i>
</button>

<!-- ğŸ†• Ø´Ø±ÙŠØ· Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø­Ø¬Ø² -->
<div class="booking-tracker" id="bookingTracker">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-8">
        <h5 class="mb-1" id="trackerTitle">Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø¬Ø²Ùƒ</h5>
        <p class="mb-1" id="trackerDetails">Ø§Ù„Ù…Ù„Ø¹Ø¨: -- | Ø§Ù„ØªØ§Ø±ÙŠØ®: -- | Ø§Ù„ÙˆÙ‚Øª: --</p>
        <div class="tracker-progress">
          <div class="tracker-progress-bar" id="trackerProgress" style="width: 0%"></div>
        </div>
        <small id="trackerStatus">Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø­Ø¬Ø²...</small>
      </div>
      <div class="col-md-4 text-left">
        <div class="d-flex gap-2">
          <button class="btn btn-outline-light btn-sm" onclick="viewBookingDetails()">
            <i class="bi bi-eye me-1"></i>Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„
          </button>
          <button class="btn btn-light btn-sm" onclick="cancelCurrentBooking()">
            <i class="bi bi-x-circle me-1"></i>Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø²
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top">
  <div class="container">
    <a class="navbar-brand" href="/">
      <!-- Ø¶Ø¹ ØµÙˆØ±Ø© Ø§Ù„Ù„ÙˆØ¬Ùˆ Ù‡Ù†Ø§ -->
      <img src="./images/logo.png" alt="Ø§Ø­Ø¬Ø²Ù„ÙŠ" class="logo-img">
      Ø§Ø­Ø¬Ø²Ù„ÙŠ
    </a>
    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link active" href="#home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#areas">Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#stadiums">Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#features">Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª</a>
        </li>
        <!-- ğŸ†• Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ù„Ø§Ø¹Ø¨ÙˆÙ†ÙŠ Ù…Ø¹Ø§ÙƒÙ… -->
        <li class="nav-item">
          <a class="nav-link" href="/players-with-you">
            <i class="bi bi-people me-1"></i>Ù„Ø§Ø¹Ø¨ÙˆÙ†ÙŠ Ù…Ø¹Ø§ÙƒÙ…
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/profile">
            <i class="bi bi-person me-1"></i>Ù…Ù„ÙÙŠ
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/login">
            <i class="bi bi-box-arrow-in-left me-1"></i>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Hero Section -->
<section class="hero-section" id="home">
  <div class="container">
    <div class="hero-content fade-in">
      <!-- ğŸ†• Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© -->
      <h1 class="hero-title text-light">Ù…Ù„Ø¹Ø¨Ùƒ ÙÙŠ Ø¶ØºØ·Ø©ØŒ ÙˆØ­Ø¬Ø²Ùƒ Ù…Ø¤ÙƒØ¯ Ø¹Ù†Ø¯Ù†Ø§</h1>
      <p class="hero-subtitle text-light">Ù…Ø¹ Ø§Ø­Ø¬Ø²Ù„ÙŠ Ù‡ØªØ¬Ø±Ø¨ Ø£Ø³Ù‡Ù„ ÙˆØ£Ø³Ø±Ø¹ Ø·Ø±ÙŠÙ‚Ø© Ù„Ø­Ø¬Ø² Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ø­Ø¬Ø²ØŒ Ù†Ø¸Ù‘Ù…ØŒ ÙˆØ§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©!</p>
      <div class="hero-buttons">
        <a href="#stadiums" class="btn btn-primary btn-lg">
          <i class="bi bi-search me-2"></i>Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†
        </a>
      </div>
    </div>
  </div>
</section>

<!-- ğŸ†• Ù‚Ø³Ù… Ø§Ù„Ø¨Ø§Ù†Ø±Ø² ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ -->
<section class="banners-section" id="banners">
  <div class="container">
    <h2 class="section-title text-white">Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„ØªØ®ÙÙŠØ¶Ø§Øª</h2>
    <div class="row" id="bannersContainer">
      <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨Ø§Ù†Ø±Ø² Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ù…Ù† API -->
      <div class="col-12 text-center">
        <div class="spinner-border text-light" role="status">
          <span class="visually-hidden">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ø±ÙˆØ¶...</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø­Ø¬Ø² -->
<section class="areas-section" id="areas">
  <div class="container">
    <h2 class="section-title">Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ø­Ø¬Ø²</h2>
    <div class="row">
      <div class="col-md-6 mb-4">
        <div class="area-card">
          <div class="area-image" style="background-image: url('./images/mokatam-area.jpg')"></div>
          <div class="area-title">Ø§Ù„Ù…Ù‚Ø·Ù…</div>
        </div>
      </div>
      <div class="col-md-6 mb-4">
        <div class="area-card">
          <div class="area-image" style="background-image: url('./images/hedaba-area.jpg')"></div>
          <div class="area-title">Ø§Ù„Ù‡Ø¶Ø¨Ø© Ø§Ù„ÙˆØ³Ø·ÙŠ</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ğŸ†• Ù‚Ø³Ù… ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ -->
<section class="how-it-works" id="how-it-works">
  <div class="container">
    <h2 class="section-title">ÙƒÙŠÙ ÙŠØ¹Ù…Ù„</h2>
    <div class="row">
      <div class="col-md-3 mb-4">
        <div class="step-card">
          <div class="step-number">1</div>
          <h4>Ø§Ø®ØªØ± Ù…Ù„Ø¹Ø¨</h4>
          <p>Ø§Ø®ØªØ± Ù…Ù† Ø¨ÙŠÙ† Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙƒ</p>
        </div>
      </div>
      <div class="col-md-3 mb-4">
        <div class="step-card">
          <div class="step-number">2</div>
          <h4>Ø­Ø¯Ø¯ Ø§Ù„ÙˆÙ‚Øª</h4>
          <p>Ø§Ø®ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ùƒ</p>
        </div>
      </div>
      <div class="col-md-3 mb-4">
        <div class="step-card">
          <div class="step-number">3</div>
          <h4>Ø£ÙƒØ¯ Ø§Ù„Ø­Ø¬Ø²</h4>
          <p>Ø§Ø¯ÙØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ† ÙˆØ£ÙƒÙ‘Ø¯ Ø­Ø¬Ø²Ùƒ</p>
        </div>
      </div>
      <div class="col-md-3 mb-4">
        <div class="step-card">
          <div class="step-number">4</div>
          <h4>Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©</h4>
          <p>Ø§Ø­Ø¶Ø± ÙÙŠ Ø§Ù„Ù…ÙˆØ¹Ø¯ ÙˆØ§Ø³ØªÙ…ØªØ¹ Ø¨Ø§Ù„Ù„Ø¹Ø¨</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ğŸ†• Ù‚Ø³Ù… Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…Ù…ÙŠØ²Ø© -->
<section class="featured-stadiums" id="featured-stadiums">
  <div class="container">
    <h2 class="section-title">ğŸ† Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…Ù…ÙŠØ²Ø©</h2>
    <div class="row" id="featuredStadiumsContainer">
      <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
    </div>
  </div>
</section>

<!-- Stadiums Section -->
<section class="py-5" id="stadiums">
  <div class="container">
    <h2 class="section-title">Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…ØªØ§Ø­Ø©</h2>
    
    <!-- ğŸ†• Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù… -->
    <div class="row mb-4">
      <div class="col-md-6 mb-3">
        <div class="search-box">
          <input type="text" class="form-control" id="searchStadiums" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©...">
          <i class="bi bi-search search-icon"></i>
        </div>
      </div>
      <div class="col-md-2 mb-3">
        <select class="form-select" id="priceFilter">
          <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</option>
          <option value="0-150">Ø­ØªÙ‰ 150 Ø¬.Ù…</option>
          <option value="150-250">150 - 250 Ø¬.Ù…</option>
          <option value="250-999">Ø£ÙƒØ«Ø± Ù…Ù† 250 Ø¬.Ù…</option>
        </select>
      </div>
      <div class="col-md-2 mb-3">
        <select class="form-select" id="ratingFilter">
          <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</option>
          <option value="4.5">â­ 4.5+ Ù…Ù…ØªØ§Ø²</option>
          <option value="4.0">â­ 4.0+ Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹</option>
          <option value="3.5">â­ 3.5+ Ø¬ÙŠØ¯</option>
        </select>
      </div>
      <div class="col-md-2 mb-3">
        <select class="form-select" id="availabilityFilter">
          <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
          <option value="available">ğŸŸ¢ Ù…ØªØ§Ø­ Ø§Ù„Ø¢Ù†</option>
          <option value="soon">ğŸŸ¡ Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹</option>
        </select>
      </div>
    </div>

    <!-- ğŸ†• ÙÙ„ØªØ±Ø© Ù…ØªÙ‚Ø¯Ù…Ø© -->
    <div class="row mb-4">
      <div class="col-md-4">
        <label class="form-label">Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</label>
        <select class="form-select" id="areaFilter">
          <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</option>
          <option value="mokatam">Ø§Ù„Ù…Ù‚Ø·Ù…</option>
          <option value="hedaba">Ø§Ù„Ù‡Ø¶Ø¨Ø© Ø§Ù„ÙˆØ³Ø·ÙŠ</option>
        </select>
      </div>
      <div class="col-md-4">
        <label class="form-label">ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨</label>
        <select class="form-select" id="sortFilter">
          <option value="default">Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ</option>
          <option value="price_low">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ø£Ø¹Ù„Ù‰</option>
          <option value="price_high">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„Ø£Ù‚Ù„</option>
          <option value="rating">Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</option>
          <option value="availability">Ø§Ù„Ø£ÙƒØ«Ø± ØªÙˆÙØ±Ø§Ù‹</option>
          <option value="popular">Ø§Ù„Ø£ÙƒØ«Ø± Ø´Ù‡Ø±Ø©</option>
        </select>
      </div>
      <div class="col-md-4">
        <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ø¹Ø¨</label>
        <select class="form-select" id="typeFilter">
          <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
          <option value="natural">Ù†Ø¬ÙŠÙ„Ø© Ø·Ø¨ÙŠØ¹ÙŠØ©</option>
          <option value="artificial">Ù†Ø¬ÙŠÙ„Ø© ØµÙ†Ø§Ø¹ÙŠØ©</option>
        </select>
      </div>
    </div>

    <!-- ğŸ†• Container Ù„Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© -->
    <div class="row" id="stadiumsContainer">
      <!-- Ø³ÙŠØªÙ… ØªØ¹Ù…Ø¦Ø© Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ù…Ù† API -->
    </div>
  </div>
</section>

<!-- Features Section -->
<section class="features-section" id="features">
  <div class="container">
    <h2 class="section-title">Ù„Ù…Ø§Ø°Ø§ ØªØ®ØªØ§Ø± Ø§Ø­Ø¬Ø²Ù„ÙŠØŸ</h2>
    <div class="row">
      <!-- ğŸ†• 4 Ù…Ù…ÙŠØ²Ø§Øª Ù…Ù‚Ù†Ø¹Ø© -->
      <div class="col-md-6 mb-4">
        <div class="feature-card">
          <div class="feature-icon">
            <i class="bi bi-lightning-charge"></i>
          </div>
          <h4>Ø­Ø¬Ø² ÙÙˆØ±ÙŠ ÙˆØ¢Ù…Ù†</h4>
          <p>Ø§Ø­Ø¬Ø² ÙˆØ§Ø¯ÙØ¹ Ø¹Ø±Ø¨ÙˆÙ†Ùƒ Ø¨Ø¨Ø¶Ø¹ Ù†Ù‚Ø±Ø§Øª. Ù†Ø¸Ø§Ù… Ø¯ÙØ¹ Ø¢Ù…Ù† ÙˆÙ…Ø´ÙÙ‘Ø±</p>
        </div>
      </div>
      <div class="col-md-6 mb-4">
        <div class="feature-card">
          <div class="feature-icon">
            <i class="bi bi-clock-history"></i>
          </div>
          <h4>Ø³Ø§Ø¹Ø§Øª Ø°Ù‡Ø¨ÙŠØ© Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</h4>
          <p>Ø§Ø¹Ù„Ù† Ø¹Ù† Ø­Ø§Ø¬ØªÙƒ Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ§Ø¬Ø°Ø¨ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†</p>
        </div>
      </div>
      <div class="col-md-6 mb-4">
        <div class="feature-card">
          <div class="feature-icon">
            <i class="bi bi-tags"></i>
          </div>
          <h4>Ù†Ø¸Ø§Ù… Ø®ØµÙˆÙ…Ø§Øª ÙˆØ¯ÙØ¹ Ø³Ù‡Ù„</h4>
          <p>Ø§Ø¯Ø¹Ù… Ø¹Ù…Ù„Ø§Ø¦Ùƒ Ø¨ÙƒÙˆØ¯ Ø®ØµÙ… Ø£Ùˆ Ø£ÙƒÙˆØ§Ø¯ Ø¯ÙØ¹ Ø¨Ù‚ÙŠÙ… Ù…Ø®ØªÙ„ÙØ©</p>
        </div>
      </div>
      <div class="col-md-6 mb-4">
        <div class="feature-card">
          <div class="feature-icon">
            <i class="bi bi-headset"></i>
          </div>
          <h4>Ø¯Ø¹Ù… ÙÙ†ÙŠ Ø³Ø±ÙŠØ¹</h4>
          <p>ÙØ±ÙŠÙ‚Ù†Ø§ Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¹Ù†Ø¯ Ø£ÙŠ Ø·Ø§Ø±Ø¦ Ø¹Ù„Ù‰ Ù…Ø¯Ø§Ø± Ø§Ù„Ø³Ø§Ø¹Ø©</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ğŸ†• Ø´Ø±ÙŠØ· Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø© -->
<section class="features-bar">
  <div class="container">
    <div class="row">
      <div class="col-md-4 col-6">
        <div class="feature-item">
          <div class="feature-icon">
            <i class="bi bi-lightning-charge"></i>
          </div>
          <div class="feature-text">Ø­Ø¬Ø² ÙÙˆØ±ÙŠ</div>
        </div>
      </div>
      <div class="col-md-4 col-6">
        <div class="feature-item">
          <div class="feature-icon">
            <i class="bi bi-shield-check"></i>
          </div>
          <div class="feature-text">Ø¯ÙØ¹ Ø¢Ù…Ù†</div>
        </div>
      </div>
      <div class="col-md-4 col-6">
        <div class="feature-item">
          <div class="feature-icon">
            <i class="bi bi-people"></i>
          </div>
          <div class="feature-text">Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¥Ø¶Ø§ÙÙŠÙŠÙ†</div>
        </div>
      </div>
      <div class="col-md-4 col-6">
        <div class="feature-item">
          <div class="feature-icon">
            <i class="bi bi-tags"></i>
          </div>
          <div class="feature-text">Ø£ÙƒÙˆØ§Ø¯ Ø®ØµÙ…</div>
        </div>
      </div>
      <div class="col-md-4 col-6">
        <div class="feature-item">
          <div class="feature-icon">
            <i class="bi bi-headset"></i>
          </div>
          <div class="feature-text">Ø¯Ø¹Ù… ÙÙ†ÙŠ</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Footer -->
<footer class="footer">
  <div class="container">
    <div class="row">
      <div class="col-lg-4 col-md-6 mb-4">
        <h5>Ø§Ø­Ø¬Ø²Ù„ÙŠ</h5>
        <p>Ø£Ù‚ÙˆÙŠ Ù…Ù†ØµØ© Ù„Ø­Ø¬Ø² Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ù†ØºØ·ÙŠ Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…Ù‚Ø·Ù…ØŒ Ø§Ù„Ù‡Ø¶Ø¨Ø© Ø§Ù„ÙˆØ³Ø·ÙŠ.</p>
        <div class="social-links">
          <a href="#"><i class="bi bi-facebook"></i></a>
          <a href="#"><i class="bi bi-whatsapp"></i></a>
          <a href="#"><i class="bi bi-instagram"></i></a>
        </div>
      </div>
      <div class="col-lg-2 col-md-6 mb-4">
        <h5>Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</h5>
        <div class="footer-links">
          <a href="#areas">Ø§Ù„Ù…Ù‚Ø·Ù…</a>
          <a href="#areas">Ø§Ù„Ù‡Ø¶Ø¨Ø© Ø§Ù„ÙˆØ³Ø·ÙŠ</a>
        </div>
      </div>
      <div class="col-lg-3 col-md-6 mb-4">
        <h5>Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹</h5>
        <div class="footer-links">
          <a href="#">ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´</a>
          <a href="#">Ø£ÙˆØ±Ù†Ø¬ ÙƒØ§Ø´</a>
          <a href="#">Ø§ØªØµØ§Ù„Ø§Øª ÙƒØ§Ø´</a>
          <a href="#">Ø¥Ù†Ø³ØªØ§Ø¨Ø§ÙŠ</a>
          <a href="#">Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¯ÙØ¹</a>
        </div>
      </div>
      <div class="col-lg-3 col-md-6 mb-4">
        <h5>Ø§ØªØµÙ„ Ø¨Ù†Ø§</h5>
        <div class="footer-links">
          <a href="tel:+201000000000"><i class="bi bi-phone me-2"></i>+20 100 000 0000</a>
          <a href="#"><i class="bi bi-geo-alt me-2"></i>Ø´Ø±Ù‚ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</a>
        </div>
      </div>
    </div>
    <hr>
    <div class="text-center py-3">
      <p class="mb-0">&copy; 2025 Ø§Ø­Ø¬Ø²Ù„ÙŠ. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
    </div>
  </div>
</footer>

<!-- Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„Ø§Øª ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ -->
<!-- Date Modal -->
<div class="modal fade date-modal" id="dateModal" tabindex="-1" role="dialog" aria-labelledby="dateModalLabel">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="dateModalLabel">Ø§Ø®ØªØ± ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¬Ø²</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
      </div>
      <div class="modal-body">
        <div class="date-options" id="dateOptions">
          <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø³Ø¨Ø¹Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© Ù‡Ù†Ø§ -->
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary w-100" data-bs-dismiss="modal">ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ§Ø±ÙŠØ®</button>
      </div>
    </div>
  </div>
</div>

<!-- Booking Modal -->
<div class="modal fade" id="bookingModal" tabindex="-1" role="dialog" aria-labelledby="bookingModalLabel">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-success text-white">
        <h5 class="modal-title" id="bookingModalLabel">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² ÙˆØ¯ÙØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
      </div>
      <div class="modal-body">
        <div id="bookingDetails" class="mb-3"></div>
        <form id="bookingForm">
          <input type="hidden" name="_csrf" id="csrfToken">
          <input type="hidden" name="pitchId" id="pitchId">
          <input type="hidden" name="selectedTime" id="selectedTime">
          <input type="hidden" name="selectedDate" id="selectedDate">
          
          <div class="mb-3">
            <label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
            <input type="text" class="form-control" id="customerName" name="name" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
            <input type="tel" class="form-control" id="customerPhone" name="phone" pattern="^01[0125][0-9]{8}$" required>
            <div class="form-text">ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø±Ù‚Ù… Ø¨Ù€ 010ØŒ 011ØŒ 012ØŒ Ø£Ùˆ 015 ÙˆÙŠØªØ¨Ø¹Ù‡ 8 Ø£Ø±Ù‚Ø§Ù…</div>
          </div>
          <div class="mb-3">
            <label class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
            <input type="email" class="form-control" id="customerEmail" name="email">
          </div>
          
          <!-- Ù‚Ø³Ù… Ø·Ù„Ø¨ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø¥Ø¶Ø§ÙÙŠÙŠÙ† -->
          <div class="mb-3">
            <label class="form-label">Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø¥Ø¶Ø§ÙÙŠÙŠÙ† Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ÙŠÙ†</label>
            <input type="number" class="form-control" id="playersNeeded" name="playersNeeded" min="0" max="10" value="0">
            <div class="form-text">
              Ø¥Ø°Ø§ Ø·Ù„Ø¨Øª Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¥Ø¶Ø§ÙÙŠÙŠÙ†ØŒ Ø³ØªØ¸Ù‡Ø± Ø³Ø§Ø¹ØªÙƒ ÙÙŠ "Ù„Ø§Ø¹Ø¨ÙˆÙ†ÙŠ Ù…Ø¹Ø§ÙƒÙ…" Ø¨Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ
            </div>
          </div>
          
          <div class="mb-3">
            <label class="form-label">ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
            <input type="text" class="form-control" id="discountCode" name="discountCode" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ">
            <div class="form-text">ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ù„Ø®ØµÙ… Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</div>
          </div>
          
          <!-- Ù‚Ø³Ù… Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¯ÙØ¹ -->
          <div class="voucher-section">
            <h6 class="mb-3">ğŸ†• Ø§Ù„Ø¯ÙØ¹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</h6>
            <div class="voucher-input-group">
              <input type="text" class="form-control voucher-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ÙˆÙ„" id="voucherCode1">
              <button type="button" class="btn btn-outline-success" onclick="validateVoucher('voucherCode1')">ØªØ­Ù‚Ù‚</button>
            </div>
            <div class="voucher-input-group">
              <input type="text" class="form-control voucher-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø«Ø§Ù†ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" id="voucherCode2">
              <button type="button" class="btn btn-outline-success" onclick="validateVoucher('voucherCode2')">ØªØ­Ù‚Ù‚</button>
            </div>
            <div class="voucher-input-group">
              <input type="text" class="form-control voucher-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø«Ø§Ù„Ø« (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" id="voucherCode3">
              <button type="button" class="btn btn-outline-success" onclick="validateVoucher('voucherCode3')">ØªØ­Ù‚Ù‚</button>
            </div>
            <div id="voucherResult" class="mt-2"></div>
          </div>
          
          <div class="alert alert-info">
            <h6 class="alert-heading">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯ÙØ¹</h6>
            <p class="mb-1">Ø³ÙŠØªÙ… Ø¯ÙØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ† ÙÙ‚Ø· Ø§Ù„Ø¢Ù† (30% Ù…Ù† Ø§Ù„Ø³Ø¹Ø±)</p>
            <p class="mb-0">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ø¹ÙŠ ÙŠØªÙ… Ø¯ÙØ¹Ù‡ Ù‚Ø¨Ù„ 48 Ø³Ø§Ø¹Ø© Ù…Ù† Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø­Ø¬Ø²</p>
          </div>
          
          <button type="submit" class="btn btn-primary w-100" id="bookingSubmitBtn">
            <i class="bi bi-credit-card me-2"></i>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² ÙˆØ¯ÙØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†
          </button>
        </form>
        <div id="bookingStatus" class="mt-3"></div>
      </div>
    </div>
  </div>
</div>

<!-- ğŸ†• Ù…ÙˆØ¯Ø§Ù„ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø² Ù…Ø¹ Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ -->
<div class="modal fade" id="cancelBookingModal" tabindex="-1" role="dialog" aria-labelledby="cancelBookingModalLabel">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title" id="cancelBookingModalLabel">ØªØ£ÙƒÙŠØ¯ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø²</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
      </div>
      <div class="modal-body">
        <div class="alert alert-warning">
          <h6><i class="bi bi-exclamation-triangle me-2"></i>ØªÙ†Ø¨ÙŠÙ‡ Ù…Ù‡Ù…</h6>
          <p class="mb-0" id="cancellationPolicy"></p>
        </div>
        
        <div id="cancellationSteps">
          <!-- Ø§Ù„Ø®Ø·ÙˆØ© 1 -->
          <div class="cancellation-step active" id="step1">
            <p>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ø¥Ù„ØºØ§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¬Ø²ØŸ</p>
            <div class="form-check mb-3">
              <input class="form-check-input" type="checkbox" id="confirmCancellation">
              <label class="form-check-label" for="confirmCancellation">
                Ù†Ø¹Ù…ØŒ Ø£Ø±ÙŠØ¯ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø²
              </label>
            </div>
          </div>
          
          <!-- Ø§Ù„Ø®Ø·ÙˆØ© 2 -->
          <div class="cancellation-step" id="step2" style="display: none;">
            <p>ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ù„ØºØ§Ø¡:</p>
            <select class="form-select" id="cancellationReason">
              <option value="">Ø§Ø®ØªØ± Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ù„ØºØ§Ø¡</option>
              <option value="ØªØºÙŠÙŠØ± ÙÙŠ Ø§Ù„Ø®Ø·Ø·">ØªØºÙŠÙŠØ± ÙÙŠ Ø§Ù„Ø®Ø·Ø·</option>
              <option value="Ø¸Ø±ÙˆÙ Ø·Ø§Ø±Ø¦Ø©">Ø¸Ø±ÙˆÙ Ø·Ø§Ø±Ø¦Ø©</option>
              <option value="ÙˆØ¬Ø¯Øª ÙˆÙ‚Øª Ø£ÙØ¶Ù„">ÙˆØ¬Ø¯Øª ÙˆÙ‚Øª Ø£ÙØ¶Ù„</option>
              <option value="Ø£Ø³Ø¨Ø§Ø¨ Ù…Ø§Ù„ÙŠØ©">Ø£Ø³Ø¨Ø§Ø¨ Ù…Ø§Ù„ÙŠØ©</option>
              <option value="Ø¢Ø®Ø±">Ø³Ø¨Ø¨ Ø¢Ø®Ø±</option>
            </select>
            <textarea class="form-control mt-2" id="otherReason" placeholder="Ø§Ø°ÙƒØ± Ø§Ù„Ø³Ø¨Ø¨ Ø¥Ø°Ø§ Ø§Ø®ØªØ±Øª 'Ø³Ø¨Ø¨ Ø¢Ø®Ø±'" style="display: none;"></textarea>
          </div>
          
          <!-- Ø§Ù„Ø®Ø·ÙˆØ© 3 -->
          <div class="cancellation-step" id="step3" style="display: none;">
            <p>Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:</p>
            <div class="alert alert-info">
              <p id="finalCancellationInfo"></p>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="finalConfirm">
              <label class="form-check-label" for="finalConfirm">
                Ø£Ù‚Ø± Ø¨Ø£Ù†ÙŠ ÙÙ‡Ù…Øª Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¥Ù„ØºØ§Ø¡ ÙˆØ£ÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§
              </label>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ØªØ±Ø§Ø¬Ø¹</button>
        <button type="button" class="btn btn-danger" id="nextCancellationStep" onclick="nextCancellationStep()">
          Ø§Ù„ØªØ§Ù„ÙŠ <i class="bi bi-arrow-left"></i>
        </button>
        <button type="button" class="btn btn-danger" id="confirmCancellationBtn" style="display: none;" onclick="confirmCancellation()">
          <i class="bi bi-check-circle me-1"></i>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ù„ØºØ§Ø¡
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Rating Modal -->
<div class="modal fade" id="ratingModal" tabindex="-1" role="dialog" aria-labelledby="ratingModalLabel">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-warning text-white">
        <h5 class="modal-title" id="ratingModalLabel">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ù„Ø¹Ø¨</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
      </div>
      <div class="modal-body">
        <div id="ratingDetails" class="mb-3"></div>
        <form id="ratingForm">
          <input type="hidden" name="_csrf" id="ratingCsrfToken">
          <input type="hidden" name="pitchId" id="ratingPitchId">
          <input type="hidden" name="bookingId" id="ratingBookingId">
          
          <div class="mb-3">
            <label class="form-label">ØªÙ‚ÙŠÙŠÙ…Ùƒ Ù„Ù„Ù…Ù„Ø¹Ø¨</label>
            <div class="rating-stars" id="ratingStars" role="radiogroup" aria-label="ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ù„Ø¹Ø¨">
              <i class="bi bi-star star" data-rating="1" role="radio" aria-checked="false" tabindex="0"></i>
              <i class="bi bi-star star" data-rating="2" role="radio" aria-checked="false" tabindex="0"></i>
              <i class="bi bi-star star" data-rating="3" role="radio" aria-checked="false" tabindex="0"></i>
              <i class="bi bi-star star" data-rating="4" role="radio" aria-checked="false" tabindex="0"></i>
              <i class="bi bi-star star" data-rating="5" role="radio" aria-checked="false" tabindex="0"></i>
            </div>
            <input type="hidden" name="rating" id="selectedRating" required>
          </div>
          
          <div class="mb-3">
            <label class="form-label">ØªØ¹Ù„ÙŠÙ‚Ùƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
            <textarea class="form-control" name="comment" id="ratingComment" rows="3" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ø¹Ù† ØªØ¬Ø±Ø¨ØªÙƒ..."></textarea>
          </div>
          
          <button type="submit" class="btn btn-warning w-100 text-white">
            <i class="bi bi-star-fill me-2"></i>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
          </button>
        </form>
        <div id="ratingStatus" class="mt-3"></div>
      </div>
    </div>
  </div>
</div>

<!-- ğŸ†• Ù…ÙˆØ¯Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† -->
<div class="modal fade" id="playersRequestModal" tabindex="-1" role="dialog" aria-labelledby="playersRequestModalLabel">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-warning text-white">
        <h5 class="modal-title" id="playersRequestModalLabel">Ø·Ù„Ø¨ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¥Ø¶Ø§ÙÙŠÙŠÙ†</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
      </div>
      <div class="modal-body">
        <div class="alert alert-info">
          <h6>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©</h6>
          <p id="goldenSlotInfo" class="mb-0"></p>
        </div>
        
        <form id="playersRequestForm">
          <input type="hidden" id="requestTimeSlotId">
          
          <div class="mb-3">
            <label class="form-label">Ø§Ø³Ù…Ùƒ</label>
            <input type="text" class="form-control" id="requesterName" required>
          </div>
          
          <div class="mb-3">
            <label class="form-label">Ø¹Ù…Ø±Ùƒ</label>
            <input type="number" class="form-control" id="requesterAge" min="15" max="60" required>
          </div>
          
          <div class="mb-3">
            <label class="form-label">Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ø¹Ùƒ</label>
            <input type="number" class="form-control" id="playersWithYou" min="1" max="10" value="1" required>
          </div>
          
          <div class="mb-3">
            <label class="form-label">ØªØ¹Ù„ÙŠÙ‚ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
            <textarea class="form-control" id="requestComment" rows="3" placeholder="Ø£Ø®Ø¨Ø± Ù…Ù†Ø¸Ù… Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ø¹Ù† Ù…Ø³ØªÙˆØ§Ùƒ Ø£Ùˆ Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª..."></textarea>
          </div>
          
          <button type="submit" class="btn btn-warning w-100 text-white">
            <i class="bi bi-send me-2"></i>Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- ğŸ†• Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ØªÙ‚Ø¯Ù… -->
<div class="modal fade" id="advancedRatingModal" tabindex="-1" role="dialog" aria-labelledby="advancedRatingModalLabel">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-warning text-white">
        <h5 class="modal-title" id="advancedRatingModalLabel">ØªÙ‚ÙŠÙŠÙ… Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ù…Ù„Ø¹Ø¨</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
      </div>
      <div class="modal-body">
        <div class="text-center mb-4">
          <button class="btn btn-outline-primary mb-2" onclick="startVoiceRating()">
            <i class="bi bi-mic me-2"></i>Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØµÙˆØªÙŠ
          </button>
          <p class="text-muted">Ù‚Ù„ "Ø®Ù…Ø³Ø© Ù†Ø¬ÙˆÙ…" Ø£Ùˆ "Ù…Ù…ØªØ§Ø²" Ø£Ùˆ Ø£ÙŠ ØªÙ‚ÙŠÙŠÙ…</p>
        </div>
        
        <div class="rating-stars mb-3" id="advancedRatingStars">
          <i class="bi bi-star star" data-rating="1"></i>
          <i class="bi bi-star star" data-rating="2"></i>
          <i class="bi bi-star star" data-rating="3"></i>
          <i class="bi bi-star star" data-rating="4"></i>
          <i class="bi bi-star star" data-rating="5"></i>
        </div>
        
        <div class="mb-3">
          <label class="form-label">ØªØ¹Ù„ÙŠÙ‚Ùƒ (ÙŠÙ…ÙƒÙ†Ùƒ ØªØ³Ø¬ÙŠÙ„ ØµÙˆØªÙŠ)</label>
          <textarea class="form-control" id="advancedRatingComment" rows="3" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ø¹Ù† ØªØ¬Ø±Ø¨ØªÙƒ..."></textarea>
        </div>
        
        <div class="d-flex gap-2">
          <button class="btn btn-primary flex-fill" onclick="submitAdvancedRating()">
            <i class="bi bi-star-fill me-2"></i>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
          </button>
          <button class="btn btn-outline-secondary" onclick="shareStadiumReview()">
            <i class="bi bi-share me-2"></i>Ù…Ø´Ø§Ø±ÙƒØ©
          </button>
        </div>
      </div>
    </div>
  </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
// ======= ğŸ¯ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© =======

// ğŸ¯ 1. Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ø±Ø¶ ÙˆØ§Ù„ØªØ­Ù…ÙŠÙ„
async function fetchStadiums() {
    try {
        showToast('Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨...', 'info');
        const stadiums = await loadStadiums(getCurrentFilters());
        renderStadiums(stadiums);
        showToast('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø¨Ù†Ø¬Ø§Ø­', 'success');
    } catch (err) {
        console.error('Error fetching stadiums:', err);
        const defaultStadiums = getDefaultStadiums();
        renderStadiums(defaultStadiums);
        showToast('Ø¬Ø§Ø±Ù Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©', 'info');
    }
}

async function fetchBanners() {
    try {
        const banners = await loadBanners();
        renderBanners(banners);
    } catch (err) {
        console.error('Error fetching banners:', err);
        renderDefaultBanners();
    }
}

async function fetchFeaturedStadiums() {
    try {
        const stadiums = await loadFeaturedStadiums();
        renderFeaturedStadiums(stadiums);
    } catch (err) {
        console.error('Error fetching featured stadiums:', err);
    }
}

// ğŸ¯ 2. Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ø±Ø¶ ÙˆØ§Ù„ØªÙ‚Ø¯ÙŠÙ…
function renderStadiums(stadiums) {
    const container = document.getElementById('stadiumsContainer');
    if (!Array.isArray(stadiums) || stadiums.length === 0) {
        container.innerHTML = getEmptyStateHTML('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø¹Ø¨ ØªØ·Ø§Ø¨Ù‚ Ø¨Ø­Ø«Ùƒ');
        return;
    }

    container.innerHTML = stadiums.map(st => {
        const nextSlot = st.nextAvailableSlot ? 
            `<div class="next-slot-badge">
               <i class="bi bi-clock"></i> Ø§Ù„ØªØ§Ù„ÙŠ: ${st.nextAvailableSlot}
             </div>` : '';

        const favoriteBtn = `
            <button class="btn btn-outline-danger btn-sm favorite-btn" 
                    data-stadium-id="${st.id}"
                    onclick="toggleFavorite(${st.id})"
                    title="Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙØ¶Ù„Ø©">
                <i class="bi bi-heart"></i>
            </button>
        `;

        return `
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="stadium-card h-100">
                    <div class="stadium-image" style="background-image: url('${st.image || 'https://placehold.co/600x400/1a7f46/white?text=Ù…Ù„Ø¹Ø¨'}')" loading="lazy">
                        <span class="stadium-badge ${getAvailabilityClass(st.availabilityPercentage)}">${getAvailabilityText(st.availabilityPercentage)}</span>
                        ${st.featured ? '<span class="featured-badge">â­ Ù…Ù…ÙŠØ²</span>' : ''}
                        <span class="stadium-price">${st.price ? st.price + ' Ø¬.Ù…/Ø³Ø§Ø¹Ø©' : '-'}</span>
                        <span class="stadium-deposit">Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†: ${st.deposit || Math.round(st.price * 0.3)} Ø¬.Ù…</span>
                    </div>
                    <div class="stadium-info">
                        <h4 class="stadium-title">${escapeHtml(st.name)}</h4>
                        <p class="stadium-location">
                            <i class="bi bi-geo-alt"></i> ${escapeHtml(st.location || 'Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…Ø­Ø¯Ø¯')}
                        </p>
                        
                        ${nextSlot}
                        
                        <div class="stadium-features">
                            ${(st.features || []).slice(0,3).map(f => `<span class="badge bg-light text-dark me-1">${f}</span>`).join('')}
                        </div>
                        
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <div class="rating-stars">
                                    ${generateStarRating(st.rating || 4.5)}
                                </div>
                                <div class="rating-text">${(st.rating || 4.5).toFixed(1)} (${st.totalRatings || 0} ØªÙ‚ÙŠÙŠÙ…)</div>
                            </div>
                            <div>
                                ${favoriteBtn}
                                <button class="btn btn-outline-warning btn-sm ms-2" onclick="showAdvancedRatingModal(${st.id})">
                                    <i class="bi bi-mic"></i>
                                </button>
                            </div>
                        </div>

                        <div class="days-selector" id="day-selector-${st.id}"></div>

                        <div class="time-slots-container" id="slots-${st.id}">
                            <p class="text-muted text-center">Ø§Ø®ØªØ± ÙŠÙˆÙ…Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</p>
                        </div>

                        <button class="btn btn-primary w-100 mt-3" onclick="bookStadium(${st.id})" id="bookBtn-${st.id}">
                            <i class="bi bi-credit-card me-2"></i>Ø§Ø­Ø¬Ø² ÙˆØ§Ø¯ÙØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†
                        </button>
                    </div>
                </div>
            </div>`;
    }).join('');

    updateFavoriteButtons();
    
    // Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªÙ‚ÙŠ Ø§Ù„Ø£ÙŠØ§Ù… Ù„ÙƒÙ„ Ù…Ù„Ø¹Ø¨
    stadiums.forEach(st => {
        setTimeout(() => {
            const daySelectorContainer = document.getElementById(`day-selector-${st.id}`);
            if (daySelectorContainer) {
                daySelectorContainer.appendChild(createDaySelector(st.id));
            }
            
            checkBookingEligibility(st.id);
        }, 100);
    });
}

function renderBanners(banners) {
    const container = document.getElementById('bannersContainer');
    if (!Array.isArray(banners) || banners.length === 0) {
        renderDefaultBanners();
        return;
    }

    container.innerHTML = banners.map(banner => `
        <div class="col-md-4 mb-3">
            <div class="banner-card">
                <div class="banner-image" style="background-image: url('${banner.image || 'https://placehold.co/600x400/667eea/white?text=Ø¹Ø±Ø¶+Ø®Ø§Øµ'}')">
                    ${banner.badge ? `<span class="banner-badge">${banner.badge}</span>` : ''}
                </div>
                <div class="banner-content">
                    <h5>${escapeHtml(banner.title)}</h5>
                    <p class="text-muted">${escapeHtml(banner.description)}</p>
                    ${banner.ctaText ? `
                        <button class="btn btn-primary w-100" onclick="${banner.ctaAction || 'showToast(\\'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡...\\', \\'info\\')'}">
                            ${banner.ctaText}
                        </button>
                    ` : ''}
                </div>
            </div>
        </div>
    `).join('');
}

function renderDefaultBanners() {
    const container = document.getElementById('bannersContainer');
    container.innerHTML = `
        <div class="col-md-4 mb-3">
            <div class="banner-card">
                <div class="banner-image" style="background-image: url('https://placehold.co/600x400/667eea/white?text=Ø®ØµÙ…+25%')">
                    <span class="banner-badge">ğŸ”¥ Ù…Ø­Ø¯ÙˆØ¯</span>
                </div>
                <div class="banner-content">
                    <h5>Ø®ØµÙ… 25% Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©</h5>
                    <p class="text-muted">Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø®ØµÙ… Ø®Ø§Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø© 8 Ù…Ø³Ø§Ø¡Ù‹</p>
                    <button class="btn btn-primary w-100" onclick="showToast('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©', 'info')">
                        Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†
                    </button>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="banner-card">
                <div class="banner-image" style="background-image: url('https://placehold.co/600x400/764ba2/white?text=Ù„Ø§Ø¹Ø¨ÙˆÙ†ÙŠ+Ù…Ø¹Ø§ÙƒÙ…')">
                    <span class="banner-badge">ğŸ‘¥ Ø¬Ø¯ÙŠØ¯</span>
                </div>
                <div class="banner-content">
                    <h5>Ù„Ø§Ø¹Ø¨ÙˆÙ†ÙŠ Ù…Ø¹Ø§ÙƒÙ… - Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©</h5>
                    <p class="text-muted">Ø§Ù†Ø¶Ù… Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø¬Ø¯ÙŠØ¯Ø© ÙˆØ§Ø¬Ø°Ø¨ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¥Ø¶Ø§ÙÙŠÙŠÙ† Ù„Ù…Ø¨Ø§Ø±Ø§ØªÙƒ</p>
                    <button class="btn btn-primary w-100" onclick="window.location.href='/players-with-you'">
                        Ø§ÙƒØªØ´Ù Ø§Ù„Ù…Ø²ÙŠØ¯
                    </button>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="banner-card">
                <div class="banner-image" style="background-image: url('https://placehold.co/600x400/1a7f46/white?text=Ø£Ø¶Ù+Ù…Ù„Ø¹Ø¨Ùƒ')">
                    <span class="banner-badge">ğŸŸï¸ Ù„Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨</span>
                </div>
                <div class="banner-content">
                    <h5>Ø£Ø¶Ù Ù…Ù„Ø¹Ø¨Ùƒ ÙˆØ²Ø¯ Ø¯Ø®Ù„Ùƒ</h5>
                    <p class="text-muted">Ø§Ù†Ø¶Ù… ÙƒØ´Ø±ÙŠÙƒ ÙˆØ§Ø¬Ø¹Ù„ Ù…Ù„Ø¹Ø¨Ùƒ Ù…Ø±Ø¦ÙŠØ§Ù‹ Ù„Ø£Ù„Ø§Ù Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</p>
                    <button class="btn btn-primary w-100" onclick="window.location.href='/add-stadium'">
                        Ø³Ø¬Ù„ Ù…Ù„Ø¹Ø¨Ùƒ
                    </button>
                </div>
            </div>
        </div>
    `;
}

function renderFeaturedStadiums(stadiums) {
    const container = document.getElementById('featuredStadiumsContainer');
    if (!Array.isArray(stadiums) || stadiums.length === 0) {
        container.innerHTML = '<div class="col-12 text-center"><p class="text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø¹Ø¨ Ù…Ù…ÙŠØ²Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</p></div>';
        return;
    }

    container.innerHTML = stadiums.map(st => {
        const img = (st.images && st.images.length) ? st.images[0] : 'https://placehold.co/600x400/1a7f46/white?text=Ù…Ù„Ø¹Ø¨+Ù…Ù…ÙŠØ²';
        const nextSlot = st.nextAvailableSlot ? 
            `<div class="next-slot-badge">
               <i class="bi bi-clock"></i> Ø§Ù„ØªØ§Ù„ÙŠ: ${st.nextAvailableSlot}
             </div>` : '';

        return `
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="stadium-card h-100">
                    <div class="stadium-image" style="background-image: url('${img}')" loading="lazy">
                        <span class="featured-badge">â­ Ù…Ù…ÙŠØ²</span>
                        <span class="stadium-badge availability-high">Ø§Ù„Ø£ÙƒØ«Ø± Ø·Ù„Ø¨Ø§Ù‹</span>
                        <span class="stadium-price">${st.price ? st.price + ' Ø¬.Ù…/Ø³Ø§Ø¹Ø©' : '-'}</span>
                    </div>
                    <div class="stadium-info">
                        <h4 class="stadium-title">${escapeHtml(st.name)}</h4>
                        <p class="stadium-location">
                            <i class="bi bi-geo-alt"></i> ${escapeHtml(st.location || 'Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…Ø­Ø¯Ø¯')}
                        </p>
                        
                        ${nextSlot}
                        
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <div class="rating-stars">
                                    ${generateStarRating(st.rating || 4.5)}
                                </div>
                                <div class="rating-text">${(st.rating || 4.5).toFixed(1)} (${st.totalRatings || 0} ØªÙ‚ÙŠÙŠÙ…)</div>
                            </div>
                        </div>

                        <button class="btn btn-primary w-100" onclick="bookStadium(${st.id})">
                            <i class="bi bi-credit-card me-2"></i>Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†
                        </button>
                    </div>
                </div>
            </div>`;
    }).join('');
}

// ğŸ¯ 3. Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
function getCurrentFilters() {
    return {
        area: document.getElementById('areaFilter')?.value || '',
        type: document.getElementById('typeFilter')?.value || '',
        minRating: document.getElementById('ratingFilter')?.value || '',
        sort: document.getElementById('sortFilter')?.value || '',
        search: document.getElementById('searchStadiums')?.value || '',
        price: document.getElementById('priceFilter')?.value || '',
        availability: document.getElementById('availabilityFilter')?.value || ''
    };
}

function getAvailabilityClass(percentage) {
    if (percentage < 30) return 'availability-low';
    if (percentage < 60) return 'availability-medium';
    return 'availability-high';
}

function getAvailabilityText(percentage) {
    if (percentage < 30) return 'Ù…Ø­Ø¯ÙˆØ¯';
    if (percentage < 60) return 'Ù…ØªÙˆØ³Ø·';
    return 'Ù…ØªØ§Ø­';
}

function getEmptyStateHTML(message) {
    return `
        <div class="col-12">
            <div class="empty-state">
                <i class="bi bi-search"></i>
                <h5>${message}</h5>
                <p>Ø¬Ø±Ø¨ ØªØ¹Ø¯ÙŠÙ„ ÙÙ„ØªØ± Ø§Ù„Ø¨Ø­Ø« Ø£Ùˆ Ø§Ù„Ø¨Ø­Ø« Ø¨ÙƒÙ„Ù…Ø§Øª Ø£Ø®Ø±Ù‰</p>
                <button class="btn btn-primary" onclick="resetFilters()">
                    <i class="bi bi-arrow-clockwise"></i> Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙÙ„Ø§ØªØ±
                </button>
            </div>
        </div>`;
}

function generateStarRating(rating) {
    let stars = '';
    const fullStars = Math.floor(rating);
    const hasHalfStar = rating % 1 >= 0.5;
    
    for (let i = 1; i <= 5; i++) {
        if (i <= fullStars) {
            stars += '<i class="bi bi-star-fill text-warning"></i>';
        } else if (i === fullStars + 1 && hasHalfStar) {
            stars += '<i class="bi bi-star-half text-warning"></i>';
        } else {
            stars += '<i class="bi bi-star text-warning"></i>';
        }
    }
    
    return stars;
}

function formatTime(hour) {
    if (hour === 0 || hour === 24) return '12 Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„';
    if (hour === 12) return '12 Ø¸Ù‡Ø±Ø§Ù‹';
    if (hour < 12) return `${hour} ØµØ¨Ø§Ø­Ø§Ù‹`;
    if (hour <= 16) return `${hour - 12} Ø¹ØµØ±Ø§Ù‹`;
    return `${hour - 12} Ù…Ø³Ø§Ø¡Ù‹`;
}

function escapeHtml(unsafe) {
    if (!unsafe) return '';
    return String(unsafe)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
}

function showToast(message, type = 'success') {
    const toast = document.createElement('div');
    toast.className = `toast ${type === 'error' ? 'bg-danger' : type === 'warning' ? 'bg-warning' : 'bg-success'}`;
    toast.textContent = message;
    document.body.appendChild(toast);
    
    setTimeout(() => {
        toast.remove();
    }, 3000);
}

function debounce(fn, delay = 300) {
    let timer;
    return (...args) => {
        clearTimeout(timer);
        timer = setTimeout(() => fn.apply(this, args), delay);
    };
}

// ğŸ¯ 4. Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
function getDefaultStadiums() {
    return [
        {
            id: 1,
            name: "Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙŠØ§Ø±Ø© - Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",
            location: "Ø§Ù„Ù…Ù‚Ø·Ù… - Ø´Ø§Ø±Ø¹ Ø§Ù„ØªØ³Ø¹ÙŠÙ†",
            area: "mokatam",
            type: "artificial",
            image: "https://placehold.co/600x400/1a7f46/white?text=Ø§Ù„Ø·ÙŠØ§Ø±Ø©+Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",
            price: 250,
            deposit: 75,
            features: ["Ù†Ø¬ÙŠÙ„Ø© ØµÙ†Ø§Ø¹ÙŠØ©", "ÙƒØ´Ø§ÙØ§Øª Ù„ÙŠÙ„ÙŠØ©", "ØºØ±Ù ØªØ¨Ø¯ÙŠÙ„"],
            rating: 4.7,
            totalRatings: 128,
            availabilityPercentage: 80,
            nextAvailableSlot: "Ø§Ù„ÙŠÙˆÙ… 6 Ù…Ø³Ø§Ø¡Ù‹"
        },
        {
            id: 2,
            name: "Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙŠØ§Ø±Ø© - Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ",
            location: "Ø§Ù„Ù…Ù‚Ø·Ù… - Ø´Ø§Ø±Ø¹ Ø§Ù„ØªØ³Ø¹ÙŠÙ†",
            area: "mokatam",
            type: "artificial",
            image: "https://placehold.co/600x400/27ae60/white?text=Ø§Ù„Ø·ÙŠØ§Ø±Ø©+Ø§Ù„Ø«Ø§Ù†ÙŠ",
            price: 220,
            deposit: 66,
            features: ["Ù†Ø¬ÙŠÙ„Ø© ØµÙ†Ø§Ø¹ÙŠØ©", "Ø¥Ø¶Ø§Ø¡Ø© Ù„ÙŠÙ„ÙŠØ©", "ØºØ±Ù ØªØ¨Ø¯ÙŠÙ„"],
            rating: 4.5,
            totalRatings: 95,
            availabilityPercentage: 60,
            nextAvailableSlot: "ØºØ¯Ø§Ù‹ 4 Ø¹ØµØ±Ø§Ù‹"
        },
        {
            id: 3,
            name: "Ø§Ù„Ø±Ø§Ø¹ÙŠ Ø§Ù„ØµØ§Ù„Ø­",
            location: "Ø§Ù„Ù…Ù‚Ø·Ù… - Ø´Ø§Ø±Ø¹ 9",
            area: "mokatam",
            type: "natural",
            image: "https://placehold.co/600x400/3498db/white?text=Ø§Ù„Ø±Ø§Ø¹ÙŠ+Ø§Ù„ØµØ§Ù„Ø­",
            price: 300,
            deposit: 90,
            features: ["Ù†Ø¬ÙŠÙ„Ø© Ø·Ø¨ÙŠØ¹ÙŠØ©", "Ù…Ù‚Ø§Ø¹Ø¯ Ø¬Ù…Ø§Ù‡ÙŠØ±", "ÙƒØ§ÙÙŠØªØ±ÙŠØ§"],
            rating: 4.8,
            totalRatings: 156,
            availabilityPercentage: 40,
            nextAvailableSlot: "Ø§Ù„ÙŠÙˆÙ… 8 Ù…Ø³Ø§Ø¡Ù‹"
        }
    ];
}

function getDefaultBanners() {
    return [
        {
            id: 1,
            title: "Ø®ØµÙ… 25% Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©",
            description: "Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø®ØµÙ… Ø®Ø§Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø© 8 Ù…Ø³Ø§Ø¡Ù‹",
            image: "https://placehold.co/600x400/667eea/white?text=Ø®ØµÙ…+25%",
            badge: "ğŸ”¥ Ù…Ø­Ø¯ÙˆØ¯",
            ctaText: "Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†",
            ctaAction: "showToast('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©', 'info')"
        },
        {
            id: 2,
            title: "Ù„Ø§Ø¹Ø¨ÙˆÙ†ÙŠ Ù…Ø¹Ø§ÙƒÙ… - Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©",
            description: "Ø§Ù†Ø¶Ù… Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø¬Ø¯ÙŠØ¯Ø© ÙˆØ§Ø¬Ø°Ø¨ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¥Ø¶Ø§ÙÙŠÙŠÙ† Ù„Ù…Ø¨Ø§Ø±Ø§ØªÙƒ",
            image: "https://placehold.co/600x400/764ba2/white?text=Ù„Ø§Ø¹Ø¨ÙˆÙ†ÙŠ+Ù…Ø¹Ø§ÙƒÙ…",
            badge: "ğŸ‘¥ Ø¬Ø¯ÙŠØ¯",
            ctaText: "Ø§ÙƒØªØ´Ù Ø§Ù„Ù…Ø²ÙŠØ¯",
            ctaAction: "window.location.href='/players-with-you'"
        },
        {
            id: 3,
            title: "Ø£Ø¶Ù Ù…Ù„Ø¹Ø¨Ùƒ ÙˆØ²Ø¯ Ø¯Ø®Ù„Ùƒ",
            description: "Ø§Ù†Ø¶Ù… ÙƒØ´Ø±ÙŠÙƒ ÙˆØ§Ø¬Ø¹Ù„ Ù…Ù„Ø¹Ø¨Ùƒ Ù…Ø±Ø¦ÙŠØ§Ù‹ Ù„Ø£Ù„Ø§Ù Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†",
            image: "https://placehold.co/600x400/1a7f46/white?text=Ø£Ø¶Ù+Ù…Ù„Ø¹Ø¨Ùƒ",
            badge: "ğŸŸï¸ Ù„Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨",
            ctaText: "Ø³Ø¬Ù„ Ù…Ù„Ø¹Ø¨Ùƒ",
            ctaAction: "window.location.href='/add-stadium'"
        }
    ];
}

// ğŸ¯ 5. Ø¯ÙˆØ§Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
function resetFilters() {
    const filters = ['areaFilter', 'typeFilter', 'ratingFilter', 'sortFilter', 'priceFilter', 'searchStadiums', 'availabilityFilter'];
    filters.forEach(filterId => {
        const element = document.getElementById(filterId);
        if (element) element.value = '';
    });
    
    fetchStadiums();
    showToast('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙ„Ø§ØªØ±', 'info');
}

function checkBookingEligibility(stadiumId) {
    const token = localStorage.getItem('authToken');
    const bookBtn = document.getElementById(`bookBtn-${stadiumId}`);
    
    if (!token && bookBtn) {
        bookBtn.innerHTML = '<i class="bi bi-person me-2"></i>Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹';
        bookBtn.onclick = () => {
            showToast('ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ù„Ø­Ø¬Ø²', 'warning');
            window.location.href = '/login';
        };
    }
}

function updateFavoriteButtons() {
    const favorites = JSON.parse(localStorage.getItem('favoriteStadiums') || '[]');
    
    document.querySelectorAll('.favorite-btn').forEach(btn => {
        const stadiumId = parseInt(btn.dataset.stadiumId);
        if (favorites.includes(stadiumId)) {
            btn.innerHTML = '<i class="bi bi-heart-fill text-danger"></i>';
            btn.title = 'Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©';
        } else {
            btn.innerHTML = '<i class="bi bi-heart"></i>';
            btn.title = 'Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙØ¶Ù„Ø©';
        }
    });
}

// ğŸ¯ 6. Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…ÙØ¶Ù„Ø©
function toggleFavorite(stadiumId) {
    let favorites = JSON.parse(localStorage.getItem('favoriteStadiums') || '[]');
    
    if (favorites.includes(stadiumId)) {
        favorites = favorites.filter(id => id !== stadiumId);
        showToast('ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ù„Ø¹Ø¨ Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©', 'info');
    } else {
        favorites.push(stadiumId);
        showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙØ¶Ù„Ø©', 'success');
    }
    
    localStorage.setItem('favoriteStadiums', JSON.stringify(favorites));
    updateFavoriteButtons();
}

// ğŸ¯ 7. Ø¯ÙˆØ§Ù„ Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯
function createDaySelector(stadiumId) {
    const daysContainer = document.createElement('div');
    
    const label = document.createElement('label');
    label.className = 'form-label';
    label.textContent = 'Ø§Ø®ØªØ± ÙŠÙˆÙ… Ø§Ù„Ø­Ø¬Ø²:';
    daysContainer.appendChild(label);

    const select = document.createElement('select');
    select.className = 'form-select day-select';
    select.onchange = () => loadStadiumSlots(stadiumId, select.value);

    const defaultOption = document.createElement('option');
    defaultOption.value = '';
    defaultOption.textContent = 'Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…';
    select.appendChild(defaultOption);

    const today = new Date();
    const dayNames = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Ø§Ù„Ø³Ø¨Øª'];
    const monthNames = ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ', 'ÙŠÙˆÙ„ÙŠÙˆ', 'Ø£ØºØ³Ø·Ø³', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'];
    
    for (let i = 0; i < 7; i++) {
        const date = new Date();
        date.setDate(today.getDate() + i);
        
        const option = document.createElement('option');
        option.value = date.toISOString().split('T')[0];
        option.textContent = `${i === 0 ? 'Ø§Ù†Ù‡Ø±Ø¯Ù‡' : dayNames[date.getDay()]} - ${date.getDate()} ${monthNames[date.getMonth()]}`;
        select.appendChild(option);
    }

    daysContainer.appendChild(select);
    return daysContainer;
}

async function loadStadiumSlots(stadiumId, date) {
    try {
        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        const availableSlots = [
            { hour: 16, start_time: 16 },
            { hour: 18, start_time: 18 },
            { hour: 20, start_time: 20 },
            { hour: 22, start_time: 22 }
        ];
        
        const slotsContainer = document.getElementById(`slots-${stadiumId}`);
        slotsContainer.innerHTML = '';
        
        if (availableSlots.length === 0) {
            const message = document.createElement('p');
            message.className = 'text-danger text-center';
            message.textContent = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ÙˆÙ‚Ø§Øª Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ§Ø±ÙŠØ®';
            slotsContainer.appendChild(message);
            return;
        }
        
        availableSlots.forEach(slot => {
            const slotElement = document.createElement('div');
            slotElement.className = 'time-slot available';
            slotElement.setAttribute('role', 'button');
            slotElement.setAttribute('tabindex', '0');
            slotElement.dataset.hour = slot.hour || slot.start_time;
            slotElement.textContent = formatTime(slot.hour || slot.start_time);

            slotElement.addEventListener('click', () => selectTimeSlot(slotElement, stadiumId, slot.hour || slot.start_time));
            slotElement.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    selectTimeSlot(slotElement, stadiumId, slot.hour || slot.start_time);
                }
            });

            slotsContainer.appendChild(slotElement);
        });
        
    } catch (error) {
        console.error('Error loading slots:', error);
        const slotsContainer = document.getElementById(`slots-${stadiumId}`);
        slotsContainer.innerHTML = '<p class="text-danger text-center">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª</p>';
    }
}

function selectTimeSlot(element, stadiumId, hour) {
    const card = element.closest('.stadium-card');
    card.querySelectorAll('.time-slot').forEach(slot => {
        slot.classList.remove('selected');
    });
    
    element.classList.add('selected');
    selectedPitchId = stadiumId;
    selectedTime = hour;
}

// ğŸ¯ 8. Ø¯ÙˆØ§Ù„ Ø§Ù„Ø­Ø¬Ø²
function bookStadium(stadiumId) {
    const token = localStorage.getItem('authToken');
    if (!token) {
        showToast('ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ù„Ø­Ø¬Ø²', 'warning');
        window.location.href = '/login';
        return;
    }

    const daySelector = document.querySelector(`#day-selector-${stadiumId} .day-select`);
    const selectedTimeElement = document.querySelector(`#slots-${stadiumId} .time-slot.selected`);
    
    if (!daySelector || !daySelector.value) {
        showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¬Ø² Ø£ÙˆÙ„Ø§Ù‹', 'error');
        return;
    }

    if (!selectedTimeElement) {
        showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ÙˆÙ‚Øª Ø§Ù„Ø­Ø¬Ø² Ø£ÙˆÙ„Ø§Ù‹', 'error');
        return;
    }

    document.getElementById('pitchId').value = stadiumId;
    document.getElementById('selectedTime').value = selectedTimeElement.dataset.hour;
    document.getElementById('selectedDate').value = daySelector.value;
    
    const bookingModal = new bootstrap.Modal(document.getElementById('bookingModal'));
    bookingModal.show();
}

// ğŸ¯ 9. Ø¯ÙˆØ§Ù„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
function initTheme() {
    const themeToggle = document.getElementById('themeToggle');
    if (!themeToggle) return;

    themeToggle.addEventListener('click', function() {
        document.body.classList.toggle('night-mode');
        const icon = this.querySelector('i');
        if (document.body.classList.contains('night-mode')) {
            icon.className = 'bi bi-sun';
            this.title = 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ';
            localStorage.setItem('theme', 'night');
        } else {
            icon.className = 'bi bi-moon';
            this.title = 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ';
            localStorage.setItem('theme', 'light');
        }
    });

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'night') {
        document.body.classList.add('night-mode');
        themeToggle.querySelector('i').className = 'bi bi-sun';
        themeToggle.title = 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ';
    }
}

// ğŸ¯ 10. Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
async function initializeApp() {
    try {
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø´ÙƒÙ„ Ù…ØªÙˆØ§Ø²ÙŠ
        await Promise.allSettled([
            fetchStadiums(),
            fetchBanners(),
            fetchFeaturedStadiums()
        ]);

        // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        setTimeout(() => {
            const loadingOverlay = document.getElementById('loadingOverlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('fade-out');
            }
        }, 1000);
        
        showToast('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„', 'success');
    } catch (error) {
        console.error('App initialization error:', error);
        const loadingOverlay = document.getElementById('loadingOverlay');
        if (loadingOverlay) {
            loadingOverlay.classList.add('fade-out');
        }
    }
}

function initEventListeners() {
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙÙ„Ø§ØªØ±
    const debouncedFilter = debounce(filterStadiums, 300);
    
    const filterIds = ['areaFilter', 'sortFilter', 'typeFilter', 'priceFilter', 'ratingFilter', 'availabilityFilter', 'searchStadiums'];
    filterIds.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
            element.addEventListener('change', debouncedFilter);
        }
    });

    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ØªÙ…Ø±ÙŠØ±
    window.addEventListener('scroll', function() {
        if (window.scrollY > 100) {
            document.querySelector('.navbar')?.classList.add('scrolled');
        } else {
            document.querySelector('.navbar')?.classList.remove('scrolled');
        }

        document.querySelectorAll('section').forEach(sec => {
            let top = window.scrollY;
            if(top >= sec.offsetTop - 200){
                document.querySelectorAll('.nav-link').forEach(a => a.classList.remove('active'));
                document.querySelector(`.nav-link[href="#${sec.id}"]`)?.classList.add('active');
            }
        });

        const toTopBtn = document.getElementById('toTop');
        if (toTopBtn) {
            toTopBtn.style.display = window.scrollY > 200 ? 'block' : 'none';
        }
    });

    // Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø£Ø¹Ù„Ù‰
    const toTopBtn = document.getElementById('toTop');
    if (toTopBtn) {
        toTopBtn.onclick = () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        };
    }

    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ù„ØºØ§Ø¡
    const cancellationReason = document.getElementById('cancellationReason');
    if (cancellationReason) {
        cancellationReason.addEventListener('change', function() {
            const otherReason = document.getElementById('otherReason');
            if (otherReason) {
                otherReason.style.display = this.value === 'Ø¢Ø®Ø±' ? 'block' : 'none';
            }
        });
    }

    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù†Ø¬ÙˆÙ… ÙÙŠ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
    document.querySelectorAll('#ratingStars .star').forEach(star => {
        star.addEventListener('click', function() {
            const rating = parseInt(this.dataset.rating);
            document.getElementById('selectedRating').value = rating;
            
            document.querySelectorAll('#ratingStars .star').forEach(s => {
                const starRating = parseInt(s.dataset.rating);
                if (starRating <= rating) {
                    s.classList.add('active', 'bi-star-fill');
                    s.classList.remove('bi-star');
                    s.setAttribute('aria-checked', 'true');
                } else {
                    s.classList.remove('active', 'bi-star-fill');
                    s.classList.add('bi-star');
                    s.setAttribute('aria-checked', 'false');
                }
            });
        });
    });
}

// ğŸ¯ 11. Ø¯Ø§Ù„Ø© Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
function filterStadiums() {
    const filters = getCurrentFilters();
    console.log('Applying filters:', filters);
    fetchStadiums();
}

// ğŸ¯ 12. ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
document.addEventListener('DOMContentLoaded', function() {
    initTheme();
    initEventListeners();
    initializeApp();
    loadGoldenSlots();
});

// ======= ğŸ”§ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© =======
let pitches = [];
let currentBookings = [];
let currentCancellationBooking = null;
let cancellationStep = 1;
let selectedDate = '';
let selectedPeriod = 'morning';
let selectedPitchId = null;
let selectedTime = '';
let discountCodes = [];
let goldenSlots = [];
let validatedVouchers = [];

// ======= ğŸ¯ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ =======
// ÙƒÙ„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø®Ø±Ù‰ Ø§Ù„ØªÙŠ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø© ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ Ù…Ø¹ Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¹Ù†Ø§ØµØ±

// Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø¯Ø§Ù„Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© Ù…Ø¹ ØªØ­Ø³ÙŠÙ†
function validateVoucher(inputId) {
    const voucherInput = document.getElementById(inputId);
    if (!voucherInput) {
        showToast('Ø¹Ù†ØµØ± Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
        return;
    }
    
    const voucherCode = voucherInput?.value?.trim();
    
    if (!voucherCode) {
        showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… Ø£ÙˆÙ„Ø§Ù‹', 'error');
        return;
    }

    showToast(`Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒÙˆØ¯: ${voucherCode}`, 'info');
    // Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙƒÙˆØ¯...
}

// Ø¯ÙˆØ§Ù„ Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
function startVoiceRating() {
    showToast('Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±', 'info');
}

function submitAdvancedRating() {
    showToast('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ØªÙ‚Ø¯Ù…', 'success');
    const modal = bootstrap.Modal.getInstance(document.getElementById('advancedRatingModal'));
    if (modal) modal.hide();
}

function shareStadiumReview() {
    showToast('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©', 'success');
}

function initVoiceRecognition() {
    console.log('Voice recognition would be initialized here');
}

// Ø¯ÙˆØ§Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
function loadPitches(pitchesData) {
    console.log('Loading pitches:', pitchesData);
}

function bookPitch(pitchId, hour) {
    bookStadium(pitchId);
}

function startCountdown(bookingId) {
    console.log('Starting countdown for booking:', bookingId);
}

// Ø¯ÙˆØ§Ù„ Golden Slots
async function loadGoldenSlots() {
    try {
        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        goldenSlots = [
            {
                id: 1,
                stadium_name: "Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙŠØ§Ø±Ø© - Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",
                date: "2024-01-15",
                start_time: "18:00",
                end_time: "19:00",
                players_needed: 3
            }
        ];
        updateGoldenSlotsDisplay();
    } catch (error) {
        console.error('Error loading golden slots:', error);
    }
}

function updateGoldenSlotsDisplay() {
    // implementation for golden slots display
}

</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // ======= ğŸ¯ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚Ù†ÙŠ Ø§Ù„Ù…Ø­Ø³Ù† - APIs ÙƒØ§Ù…Ù„Ø© =======

  // ğŸ¯ 1. Ø¯ÙˆØ§Ù„ Ø§Ù„Ù€ API Ø§Ù„Ù…Ø­Ø³Ù†Ø©
  async function loadStadiums(filters = {}) {
      try {
          showToast('Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨...', 'info');
          
          // Ø¨Ù†Ø§Ø¡ parameters Ø§Ù„ÙÙ„ØªØ±Ø©
          const params = new URLSearchParams();
          if (filters.area) params.append('area', filters.area);
          if (filters.type) params.append('type', filters.type);
          if (filters.minPrice) params.append('minPrice', filters.minPrice);
          if (filters.maxPrice) params.append('maxPrice', filters.maxPrice);
          if (filters.minRating) params.append('minRating', filters.minRating);
          if (filters.sort) params.append('sort', filters.sort);
          if (filters.search) params.append('search', filters.search);
          if (filters.featured) params.append('featured', 'true');
          
          const res = await fetch(`/api/stadiums?${params}`);
          if (!res.ok) throw new Error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨');
          
          const stadiums = await res.json();
          return stadiums;
      } catch (err) {
          console.error('Error loading stadiums:', err);
          // Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙƒØ­Ù„ Ø¨Ø¯ÙŠÙ„
          return getDefaultStadiums();
      }
  }

  // ğŸ¯ 2. Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø§Ù†Ø±Ø² Ø§Ù„Ù…Ø­Ø³Ù†Ø©
  async function loadBanners() {
      try {
          const res = await fetch('/api/homepage-banners?active=true');
          if (!res.ok) throw new Error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø§Ù†Ø±Ø²');
          return await res.json();
      } catch (err) {
          console.error('Error loading banners:', err);
          return getDefaultBanners();
      }
  }

  // ğŸ¯ 3. Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…Ù…ÙŠØ²Ø©
  async function loadFeaturedStadiums() {
      try {
          const res = await fetch('/api/stadiums?featured=true&limit=3&sort=popular');
          if (!res.ok) throw new Error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…Ù…ÙŠØ²Ø©');
          return await res.json();
      } catch (err) {
          console.error('Error loading featured stadiums:', err);
          return getDefaultStadiums().slice(0, 3);
      }
  }

  // ğŸ¯ 4. Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
  async function searchStadiums(query) {
      try {
          const res = await fetch(`/api/stadiums/search?q=${encodeURIComponent(query)}`);
          if (!res.ok) throw new Error('ÙØ´Ù„ Ø§Ù„Ø¨Ø­Ø«');
          return await res.json();
      } catch (err) {
          console.error('Search error:', err);
          // Ø¨Ø­Ø« Ù…Ø­Ù„ÙŠ ÙƒØ¨Ø¯ÙŠÙ„
          const allStadiums = getDefaultStadiums();
          return allStadiums.filter(stadium => 
              stadium.name.toLowerCase().includes(query.toLowerCase()) ||
              stadium.location.toLowerCase().includes(query.toLowerCase())
          );
      }
  }

  // ğŸ¯ 5. Ø¯ÙˆØ§Ù„ Ø§Ù„ÙÙ„ØªØ±Ø©
  async function filterByArea(area) {
      return await loadStadiums({ area });
  }

  async function filterByType(type) {
      return await loadStadiums({ type });
  }

  async function filterByRating(minRating) {
      return await loadStadiums({ minRating });
  }

  async function filterByPrice(minPrice, maxPrice) {
      return await loadStadiums({ minPrice, maxPrice });
  }

  // ğŸ¯ 6. Ø¯Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
  async function getNextAvailableSlot(stadiumId) {
      try {
          const res = await fetch(`/api/stadiums/${stadiumId}/next-available-slot`);
          if (!res.ok) throw new Error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø§Ø¹Ø§Øª');
          const data = await res.json();
          return data.nextAvailable;
      } catch (err) {
          console.error('Error loading next slot:', err);
          // Ø¨ÙŠØ§Ù†Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
          const slots = ['Ø§Ù„ÙŠÙˆÙ… 6 Ù…Ø³Ø§Ø¡Ù‹', 'ØºØ¯Ø§Ù‹ 4 Ø¹ØµØ±Ø§Ù‹', 'Ø§Ù„ÙŠÙˆÙ… 8 Ù…Ø³Ø§Ø¡Ù‹'];
          return slots[Math.floor(Math.random() * slots.length)];
      }
  }

  // ğŸ¯ 7. Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
  async function submitRating(ratingData) {
      try {
          const res = await fetch('/api/ratings', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
                  'Authorization': `Bearer ${localStorage.getItem('authToken')}`
              },
              body: JSON.stringify(ratingData)
          });
          
          if (!res.ok) throw new Error('ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…');
          return await res.json();
      } catch (err) {
          console.error('Rating submission error:', err);
          throw err;
      }
  }

  // ğŸ¯ 8. Ø¯Ø§Ù„Ø© Ø§Ù„Ø­Ø¬Ø² Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚
  async function bookStadiumWithAuth(bookingData) {
      const token = localStorage.getItem('authToken');
      if (!token) {
          throw new Error('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
      }

      try {
          const res = await fetch('/api/bookings', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
                  'Authorization': `Bearer ${token}`
              },
              body: JSON.stringify(bookingData)
          });

          if (!res.ok) {
              const error = await res.json();
              throw new Error(error.message || 'ÙØ´Ù„ Ø§Ù„Ø­Ø¬Ø²');
          }

          return await res.json();
      } catch (err) {
          console.error('Booking error:', err);
          throw err;
      }
  }

  // ======= ğŸš€ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© Ø§Ù„Ù…Ø¨Ù‡Ø±Ø© =======

  // ğŸŒŸ 1. WebSocket Ù„Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„Ø­Ø¸ÙŠ
  function initializeWebSocket() {
      try {
          const socket = new WebSocket('wss://your-domain.com/ws/bookings');
          
          socket.onopen = () => {
              console.log('WebSocket connected for real-time updates');
          };

          socket.onmessage = (event) => {
              const data = JSON.parse(event.data);
              handleRealTimeUpdate(data);
          };

          socket.onclose = () => {
              console.log('WebSocket disconnected');
              // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
              setTimeout(initializeWebSocket, 5000);
          };

          return socket;
      } catch (err) {
          console.error('WebSocket error:', err);
      }
  }

  function handleRealTimeUpdate(data) {
      switch (data.type) {
          case 'booking_confirmed':
              showToast(`âœ… ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø­Ø¬Ø²Ùƒ ÙÙŠ ${data.stadiumName}`, 'success');
              updateStadiumAvailability(data.stadiumId);
              break;
          case 'slot_taken':
              showToast('âš ï¸ Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„ØªÙŠ Ø§Ø®ØªØ±ØªÙ‡Ø§ ØªÙ… Ø­Ø¬Ø²Ù‡Ø§ Ø§Ù„Ø¢Ù†ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ÙˆÙ‚Øª Ø¢Ø®Ø±', 'warning');
              refreshTimeSlots(data.stadiumId);
              break;
          case 'new_golden_slot':
              showToast('ğŸ‰ ØªÙˆØ¬Ø¯ Ø³Ø§Ø¹Ø© Ø°Ù‡Ø¨ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø© ØªØ­ØªØ§Ø¬ Ù„Ø§Ø¹Ø¨ÙŠÙ†!', 'info');
              loadGoldenSlots();
              break;
      }
  }

  // ğŸŒŸ 2. Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ø§Ù‚ØªØ±Ø§Ø­ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨
  async function getAISuggestions(userId) {
      try {
          const res = await fetch(`/api/ai/suggestions?userId=${userId}`);
          if (!res.ok) throw new Error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª');
          return await res.json();
      } catch (err) {
          console.error('AI suggestions error:', err);
          return getDefaultSuggestions();
      }
  }

  function getDefaultSuggestions() {
      // Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø°ÙƒÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„ØªØ§Ø±ÙŠØ®
      const hour = new Date().getHours();
      let suggestions = [];

      if (hour >= 18 || hour < 6) {
          suggestions = ['Ù…Ù„Ø§Ø¹Ø¨ Ø¨Ø¥Ø¶Ø§Ø¡Ø© Ù„ÙŠÙ„ÙŠØ©', 'Ù…Ù„Ø§Ø¹Ø¨ Ù‚Ø±ÙŠØ¨Ø© Ù…Ù† Ù…ÙˆÙ‚Ø¹Ùƒ'];
      } else if (hour >= 6 && hour < 12) {
          suggestions = ['Ù…Ù„Ø§Ø¹Ø¨ Ø¨Ø£Ø³Ø¹Ø§Ø± Ø§Ù„ØµØ¨Ø§Ø­', 'Ù…Ù„Ø§Ø¹Ø¨ Ù‡Ø§Ø¯Ø¦Ø©'];
      } else {
          suggestions = ['Ù…Ù„Ø§Ø¹Ø¨ Ù…ÙƒÙŠÙØ©', 'Ù…Ù„Ø§Ø¹Ø¨ Ø¨Ù…Ø³Ø§Ø­Ø§Øª ÙˆØ§Ø³Ø¹Ø©'];
      }

      return { suggestions, stadiums: getDefaultStadiums().slice(0, 2) };
  }

  // ğŸŒŸ 3. Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ÙØ¶Ù„Ø©
  function toggleFavorite(stadiumId) {
      let favorites = JSON.parse(localStorage.getItem('favoriteStadiums') || '[]');
      
      if (favorites.includes(stadiumId)) {
          favorites = favorites.filter(id => id !== stadiumId);
          showToast('ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ù„Ø¹Ø¨ Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©', 'info');
      } else {
          favorites.push(stadiumId);
          showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙØ¶Ù„Ø©', 'success');
      }
      
      localStorage.setItem('favoriteStadiums', JSON.stringify(favorites));
      updateFavoriteButtons();
  }

  function updateFavoriteButtons() {
      const favorites = JSON.parse(localStorage.getItem('favoriteStadiums') || '[]');
      
      document.querySelectorAll('.favorite-btn').forEach(btn => {
          const stadiumId = parseInt(btn.dataset.stadiumId);
          if (favorites.includes(stadiumId)) {
              btn.innerHTML = '<i class="bi bi-heart-fill text-danger"></i>';
              btn.title = 'Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©';
          } else {
              btn.innerHTML = '<i class="bi bi-heart"></i>';
              btn.title = 'Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙØ¶Ù„Ø©';
          }
      });
  }

  // ğŸŒŸ 4. Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
  function initVoiceRating() {
      if ('webkitSpeechRecognition' in window) {
          const recognition = new webkitSpeechRecognition();
          recognition.continuous = false;
          recognition.interimResults = false;
          recognition.lang = 'ar-SA';

          recognition.onresult = (event) => {
              const transcript = event.results[0][0].transcript;
              processVoiceRating(transcript);
          };

          return recognition;
      }
      return null;
  }

  function processVoiceRating(transcript) {
      const ratingMap = {
          'ÙˆØ§Ø­Ø¯': 1, 'Ø§Ø­Ø¯': 1, 'ÙˆØ§Ø­Ø¯ Ù†Ø¬Ù…Ø©': 1,
          'Ø§ØªÙ†ÙŠÙ†': 2, 'Ø§Ø«Ù†ÙŠÙ†': 2, 'Ø§ØªÙ†ÙŠÙ† Ù†Ø¬Ù…Ø©': 2,
          'ØªÙ„Ø§ØªØ©': 3, 'Ø«Ù„Ø§Ø«Ø©': 3, 'ØªÙ„Ø§ØªØ© Ù†Ø¬ÙˆÙ…': 3,
          'Ø§Ø±Ø¨Ø¹Ø©': 4, 'Ø£Ø±Ø¨Ø¹Ø©': 4, 'Ø§Ø±Ø¨Ø¹Ø© Ù†Ø¬ÙˆÙ…': 4,
          'Ø®Ù…Ø³Ø©': 5, 'Ø®Ù…Ø³Ø© Ù†Ø¬ÙˆÙ…': 5, 'Ù…Ù…ØªØ§Ø²': 5
      };

      const words = transcript.toLowerCase().split(' ');
      for (let word of words) {
          if (ratingMap[word]) {
              const rating = ratingMap[word];
              document.getElementById('selectedRating').value = rating;
              updateStarRating(rating);
              showToast(`ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¥Ù„Ù‰ ${rating} Ù†Ø¬ÙˆÙ…`, 'success');
              return;
          }
      }
      
      showToast('Ù„Ù… Ø£ÙÙ‡Ù… Ø§Ù„ØªÙ‚ÙŠÙŠÙ…ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰', 'error');
  }

  // ğŸŒŸ 5. Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø­Ø¬Ø²
  function generateShareableLink(bookingId) {
      const baseUrl = window.location.origin;
      return `${baseUrl}/booking/${bookingId}?ref=share`;
  }

  async function shareBooking(bookingId, platform = 'whatsapp') {
      const shareUrl = generateShareableLink(bookingId);
      const message = `Ø§Ù†Ø¶Ù… Ù„ÙŠ ÙÙŠ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©! ğŸ¯ ${shareUrl}`;

      switch (platform) {
          case 'whatsapp':
              window.open(`https://wa.me/?text=${encodeURIComponent(message)}`, '_blank');
              break;
          case 'telegram':
              window.open(`https://t.me/share/url?url=${encodeURIComponent(shareUrl)}&text=${encodeURIComponent(message)}`, '_blank');
              break;
          case 'copy':
              navigator.clipboard.writeText(shareUrl).then(() => {
                  showToast('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©', 'success');
              });
              break;
      }
  }

  // ======= ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© =======

  // ØªØ­Ø¯ÙŠØ« Ø¯Ø§Ù„Ø© fetchStadiums Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
  async function fetchStadiums() {
      try {
          showToast('Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨...', 'info');
          
          // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©
          const filters = getCurrentFilters();
          const stadiums = await loadStadiums(filters);
          
          renderStadiums(stadiums);
          showToast('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø¨Ù†Ø¬Ø§Ø­', 'success');
      } catch (err) {
          console.error('Error fetching stadiums:', err);
          const defaultStadiums = getDefaultStadiums();
          renderStadiums(defaultStadiums);
          showToast('Ø¬Ø§Ø±Ù Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©', 'info');
      }
  }

  // ØªØ­Ø¯ÙŠØ« Ø¯Ø§Ù„Ø© renderStadiums
  function renderStadiums(stadiums) {
      const container = document.getElementById('stadiumsContainer');
      if (!Array.isArray(stadiums) || stadiums.length === 0) {
          container.innerHTML = getEmptyStateHTML('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø¹Ø¨ ØªØ·Ø§Ø¨Ù‚ Ø¨Ø­Ø«Ùƒ');
          return;
      }

      container.innerHTML = stadiums.map(st => {
          const nextSlot = st.nextAvailableSlot ? 
              `<div class="next-slot-badge">
                 <i class="bi bi-clock"></i> Ø§Ù„ØªØ§Ù„ÙŠ: ${st.nextAvailableSlot}
               </div>` : '';

          // ğŸ†• Ø²Ø± Ø§Ù„Ù…ÙØ¶Ù„Ø©
          const favoriteBtn = `
              <button class="btn btn-outline-danger btn-sm favorite-btn" 
                      data-stadium-id="${st.id}"
                      onclick="toggleFavorite(${st.id})"
                      title="Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙØ¶Ù„Ø©">
                  <i class="bi bi-heart"></i>
              </button>
          `;

          return `
              <div class="col-lg-4 col-md-6 mb-4">
                  <div class="stadium-card h-100">
                      <div class="stadium-image" style="background-image: url('${st.image || 'https://placehold.co/600x400/1a7f46/white?text=Ù…Ù„Ø¹Ø¨'}')" loading="lazy">
                          <span class="stadium-badge ${getAvailabilityClass(st.availabilityPercentage)}">${getAvailabilityText(st.availabilityPercentage)}</span>
                          ${st.featured ? '<span class="featured-badge">â­ Ù…Ù…ÙŠØ²</span>' : ''}
                          <span class="stadium-price">${st.price ? st.price + ' Ø¬.Ù…/Ø³Ø§Ø¹Ø©' : '-'}</span>
                          <span class="stadium-deposit">Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†: ${st.deposit || Math.round(st.price * 0.3)} Ø¬.Ù…</span>
                      </div>
                      <div class="stadium-info">
                          <h4 class="stadium-title">${escapeHtml(st.name)}</h4>
                          <p class="stadium-location">
                              <i class="bi bi-geo-alt"></i> ${escapeHtml(st.location || 'Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…Ø­Ø¯Ø¯')}
                          </p>
                          
                          ${nextSlot}
                          
                          <div class="stadium-features">
                              ${(st.features || []).slice(0,3).map(f => `<span class="badge bg-light text-dark me-1">${f}</span>`).join('')}
                          </div>
                          
                          <div class="d-flex justify-content-between align-items-center mb-3">
                              <div>
                                  <div class="rating-stars">
                                      ${generateStarRating(st.rating || 4.5)}
                                  </div>
                                  <div class="rating-text">${(st.rating || 4.5).toFixed(1)} (${st.totalRatings || 0} ØªÙ‚ÙŠÙŠÙ…)</div>
                              </div>
                              <div>
                                  ${favoriteBtn}
                                  <button class="btn btn-outline-warning btn-sm ms-2" onclick="showAdvancedRatingModal(${st.id})">
                                      <i class="bi bi-mic"></i>
                                  </button>
                              </div>
                          </div>

                          <div class="days-selector" id="day-selector-${st.id}"></div>

                          <div class="time-slots-container" id="slots-${st.id}">
                              <p class="text-muted text-center">Ø§Ø®ØªØ± ÙŠÙˆÙ…Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</p>
                          </div>

                          <button class="btn btn-primary w-100 mt-3" onclick="bookStadium(${st.id})" id="bookBtn-${st.id}">
                              <i class="bi bi-credit-card me-2"></i>Ø§Ø­Ø¬Ø² ÙˆØ§Ø¯ÙØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†
                          </button>
                      </div>
                  </div>
              </div>`;
      }).join('');

      updateFavoriteButtons();
      
      // ğŸ†• ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
      document.getElementById('themeToggle').addEventListener('click', function() {
          document.body.classList.toggle('night-mode');
          const icon = this.querySelector('i');
          if (document.body.classList.contains('night-mode')) {
              icon.className = 'bi bi-sun';
              this.title = 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ';
              localStorage.setItem('theme', 'night');
          } else {
              icon.className = 'bi bi-moon';
              this.title = 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ';
              localStorage.setItem('theme', 'light');
          }
      });

      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'night') {
          document.body.classList.add('night-mode');
          document.getElementById('themeToggle').querySelector('i').className = 'bi bi-sun';
          document.getElementById('themeToggle').title = 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ';
      }
      // Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªÙ‚ÙŠ Ø§Ù„Ø£ÙŠØ§Ù… Ù„ÙƒÙ„ Ù…Ù„Ø¹Ø¨
      stadiums.forEach(st => {
          setTimeout(() => {
              const daySelectorContainer = document.getElementById(`day-selector-${st.id}`);
              if (daySelectorContainer) {
                  daySelectorContainer.appendChild(createDaySelector(st.id));
              }
              
              // ğŸ†• Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø²Ø± Ø§Ù„Ø­Ø¬Ø²
              checkBookingEligibility(st.id);
          }, 100);
      });
  }

  // ğŸ†• Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø²Ø± Ø§Ù„Ø­Ø¬Ø²
  function checkBookingEligibility(stadiumId) {
      const token = localStorage.getItem('authToken');
      const bookBtn = document.getElementById(`bookBtn-${stadiumId}`);
      
      if (!token && bookBtn) {
          bookBtn.innerHTML = '<i class="bi bi-person me-2"></i>Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹';
          bookBtn.onclick = () => {
              showToast('ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ù„Ø­Ø¬Ø²', 'warning');
              window.location.href = '/login';
          };
      }
  }

  // ======= ğŸ¯ Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø§Ù„Ù…Ø­Ø³Ù†Ø© =======

  document.addEventListener('DOMContentLoaded', function() {
      // Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
      initializeApp();
      
      // ğŸ†• WebSocket Ù„Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„Ø­Ø¸ÙŠ
      initializeWebSocket();
      
      // ğŸ†• Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ
      initVoiceRecognition();
  });

  async function initializeApp() {
      try {
          // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø´ÙƒÙ„ Ù…ØªÙˆØ§Ø²ÙŠ
          const [stadiums, banners, featured] = await Promise.allSettled([
              fetchStadiums(),
              fetchBanners(),
              fetchFeaturedStadiums()
          ]);

          // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
          document.getElementById('loadingOverlay').classList.add('fade-out');
          
          showToast('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„', 'success');
      } catch (error) {
          console.error('App initialization error:', error);
          document.getElementById('loadingOverlay').classList.add('fade-out');
      }
  }

  // ğŸ†• Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©
  function getCurrentFilters() {
      return {
          area: document.getElementById('areaFilter').value,
          type: document.getElementById('typeFilter').value,
          minRating: document.getElementById('ratingFilter').value,
          sort: document.getElementById('sortFilter').value,
          search: document.getElementById('searchStadiums').value
      };
  }

  function getAvailabilityClass(percentage) {
      if (percentage < 30) return 'availability-low';
      if (percentage < 60) return 'availability-medium';
      return 'availability-high';
  }

  function getAvailabilityText(percentage) {
      if (percentage < 30) return 'Ù…Ø­Ø¯ÙˆØ¯';
      if (percentage < 60) return 'Ù…ØªÙˆØ³Ø·';
      return 'Ù…ØªØ§Ø­';
  }

  function getEmptyStateHTML(message) {
      return `
          <div class="col-12">
              <div class="empty-state">
                  <i class="bi bi-search"></i>
                  <h5>${message}</h5>
                  <p>Ø¬Ø±Ø¨ ØªØ¹Ø¯ÙŠÙ„ ÙÙ„ØªØ± Ø§Ù„Ø¨Ø­Ø« Ø£Ùˆ Ø§Ù„Ø¨Ø­Ø« Ø¨ÙƒÙ„Ù…Ø§Øª Ø£Ø®Ø±Ù‰</p>
                  <button class="btn btn-primary" onclick="resetFilters()">
                      <i class="bi bi-arrow-clockwise"></i> Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙÙ„Ø§ØªØ±
                  </button>
              </div>
          </div>`;
  }

  // ğŸ†• Ø¯Ø§Ù„Ø© Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙÙ„Ø§ØªØ±
  function resetFilters() {
      document.getElementById('areaFilter').value = '';
      document.getElementById('typeFilter').value = '';
      document.getElementById('ratingFilter').value = '';
      document.getElementById('sortFilter').value = 'default';
      document.getElementById('priceFilter').value = '';
      document.getElementById('searchStadiums').value = '';
      
      fetchStadiums();
      showToast('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙ„Ø§ØªØ±', 'info');
  }

  // ğŸ†• Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
  function showAdvancedRatingModal(stadiumId) {
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ù„Ù„ØµÙØ­Ø© Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯
      if (!document.getElementById('advancedRatingModal')) {
          const modalHTML = `
              <div class="modal fade" id="advancedRatingModal" tabindex="-1">
                  <div class="modal-dialog modal-dialog-centered">
                      <div class="modal-content">
                          <div class="modal-header bg-warning text-white">
                              <h5 class="modal-title">ØªÙ‚ÙŠÙŠÙ… Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ù…Ù„Ø¹Ø¨</h5>
                              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                          </div>
                          <div class="modal-body">
                              <div class="text-center mb-4">
                                  <button class="btn btn-outline-primary mb-2" onclick="startVoiceRating()">
                                      <i class="bi bi-mic me-2"></i>Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØµÙˆØªÙŠ
                                  </button>
                                  <p class="text-muted">Ù‚Ù„ "Ø®Ù…Ø³Ø© Ù†Ø¬ÙˆÙ…" Ø£Ùˆ "Ù…Ù…ØªØ§Ø²" Ø£Ùˆ Ø£ÙŠ ØªÙ‚ÙŠÙŠÙ…</p>
                              </div>
                              
                              <div class="rating-stars mb-3" id="advancedRatingStars">
                                  <i class="bi bi-star star" data-rating="1"></i>
                                  <i class="bi bi-star star" data-rating="2"></i>
                                  <i class="bi bi-star star" data-rating="3"></i>
                                  <i class="bi bi-star star" data-rating="4"></i>
                                  <i class="bi bi-star star" data-rating="5"></i>
                              </div>
                              
                              <div class="mb-3">
                                  <label class="form-label">ØªØ¹Ù„ÙŠÙ‚Ùƒ (ÙŠÙ…ÙƒÙ†Ùƒ ØªØ³Ø¬ÙŠÙ„ ØµÙˆØªÙŠ)</label>
                                  <textarea class="form-control" id="advancedRatingComment" rows="3" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ø¹Ù† ØªØ¬Ø±Ø¨ØªÙƒ..."></textarea>
                              </div>
                              
                              <div class="d-flex gap-2">
                                  <button class="btn btn-primary flex-fill" onclick="submitAdvancedRating()">
                                      <i class="bi bi-star-fill me-2"></i>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
                                  </button>
                                  <button class="btn btn-outline-secondary" onclick="shareStadiumReview()">
                                      <i class="bi bi-share me-2"></i>Ù…Ø´Ø§Ø±ÙƒØ©
                                  </button>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
          `;
          document.body.insertAdjacentHTML('beforeend', modalHTML);
      }
      
      const ratingModal = new bootstrap.Modal(document.getElementById('advancedRatingModal'));
      ratingModal.show();
  }

  // ======= ğŸ”„ ÙƒÙ„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ =======

  // ğŸ¯ Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¬Ø² Ø§Ù„Ù‚Ø¯ÙŠÙ… - Ù…Ø¯Ù…Ø¬ Ù…Ø¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯
  let pitches = [];
  let currentBookings = [];
  let currentCancellationBooking = null;
  let cancellationStep = 1;
  let selectedDate = '';
  let selectedPeriod = 'morning';
  let selectedPitchId = null;
  let selectedTime = '';
  let discountCodes = [];
  let goldenSlots = [];
  let validatedVouchers = [];

  // âœ… Ø¯ÙˆØ§Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ… - Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
  async function loadPitchesData() {
      try {
          const response = await safeFetch('/api/pitches');
          pitches = await response;
          
          for (let pitch of pitches) {
              await loadPitchAvailability(pitch.id);
          }
          
          loadPitches(pitches);
          loadCurrentBookings();
          
          document.getElementById('loadingOverlay').classList.add('fade-out');
      } catch (error) {
          console.error('Error loading pitches:', error);
          pitches = getDefaultPitches();
          loadPitches(pitches);
          document.getElementById('loadingOverlay').classList.add('fade-out');
      }
  }

  async function loadPitchAvailability(pitchId) {
      try {
          const today = new Date().toISOString().split('T')[0];
          const data = await safeFetch(`/api/pitches/${pitchId}/available-slots?date=${today}&period=all`);
          
          const pitch = pitches.find(p => p.id === pitchId);
          if (pitch) {
              pitch.availability = data.availableCount;
              pitch.totalSlots = data.totalSlots;
              pitch.availabilityPercentage = (data.availableCount / data.totalSlots) * 100;
          }
      } catch (error) {
          console.error('Error loading availability:', error);
      }
  }

  async function loadCurrentBookings() {
      try {
          const bookings = await safeFetch('/api/user/bookings');
          currentBookings = bookings.filter(b => 
              b.status === 'confirmed' && 
              new Date(b.date) > new Date()
          );
          
          if (currentBookings.length > 0) {
              showBookingTracker(currentBookings[0]);
          }
      } catch (error) {
          console.error('Error loading bookings:', error);
      }
  }

  function showBookingTracker(booking) {
      const tracker = document.getElementById('bookingTracker');
      const progress = document.getElementById('trackerProgress');
      
      if (!booking.createdAt) {
          console.warn('Booking createdAt is missing');
          return;
      }

      document.getElementById('trackerTitle').textContent = `Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø¬Ø²: ${escapeHtml(booking.pitchName)}`;
      document.getElementById('trackerDetails').textContent = 
          `Ø§Ù„Ù…Ù„Ø¹Ø¨: ${escapeHtml(booking.pitchName)} | Ø§Ù„ØªØ§Ø±ÙŠØ®: ${escapeHtml(booking.date)} | Ø§Ù„ÙˆÙ‚Øª: ${escapeHtml(booking.time)}`;
      
      const now = new Date();
      const bookingDate = new Date(booking.date);
      const createdAt = new Date(booking.createdAt);
      
      if (isNaN(bookingDate.getTime()) || isNaN(createdAt.getTime())) {
          console.error('Invalid date format in booking data');
          return;
      }

      const totalTime = bookingDate - createdAt;
      const elapsedTime = now - createdAt;
      const progressPercent = Math.min((elapsedTime / totalTime) * 100, 100);
      
      progress.style.width = `${progressPercent}%`;
      
      const timeLeft = bookingDate - now;
      const hoursLeft = Math.floor(timeLeft / (1000 * 60 * 60));
      
      if (hoursLeft > 48) {
          document.getElementById('trackerStatus').textContent = `Ù…ØªØ¨Ù‚ÙŠ ${hoursLeft} Ø³Ø§Ø¹Ø© Ù„Ù„Ø­Ø¬Ø² - Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${booking.remainingAmount} Ø¬Ù†ÙŠÙ‡`;
      } else if (hoursLeft > 0) {
          document.getElementById('trackerStatus').textContent = `Ù…ØªØ¨Ù‚ÙŠ ${hoursLeft} Ø³Ø§Ø¹Ø© Ù„Ù„Ø­Ø¬Ø² - ÙŠØ±Ø¬Ù‰ Ø¯ÙØ¹ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ`;
      } else {
          document.getElementById('trackerStatus').textContent = 'ØªÙ… Ø§Ù†ØªÙ‡Ø§Ø¡ ÙˆÙ‚Øª Ø§Ù„Ø­Ø¬Ø²';
      }
      
      tracker.style.display = 'block';
  }

  // âœ… Ù†Ø¸Ø§Ù… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø² - Ù…Ø­ÙÙˆØ¸ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
  function cancelCurrentBooking() {
      if (currentBookings.length === 0) {
          showToast('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø¬ÙˆØ²Ø§Øª Ø­Ø§Ù„ÙŠØ©', 'error');
          return;
      }
      
      currentCancellationBooking = currentBookings[0];
      const bookingDate = new Date(currentCancellationBooking.date);
      const now = new Date();
      const hoursDiff = (bookingDate - now) / (1000 * 60 * 60);
      
      let policyText = '';
      if (hoursDiff > 48) {
          policyText = 'Ø³ÙŠØªÙ… Ø§Ø³ØªØ±Ø¯Ø§Ø¯ ÙƒØ§Ù…Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ + ÙƒÙˆØ¯ ØªØ¹ÙˆÙŠØ¶ ØµØ§Ù„Ø­ Ù„Ù…Ø¯Ø© 14 ÙŠÙˆÙ….';
      } else if (hoursDiff > 24) {
          policyText = 'Ø³ÙŠØªÙ… Ø¥ØµØ¯Ø§Ø± ÙƒÙˆØ¯ ØªØ¹ÙˆÙŠØ¶ ØµØ§Ù„Ø­ Ù„Ù…Ø¯Ø© 14 ÙŠÙˆÙ… (Ø¨Ø¯ÙˆÙ† Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ù†Ù‚Ø¯ÙŠ).';
      } else {
          policyText = 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨Ù„Øº Ø£Ùˆ Ø¥ØµØ¯Ø§Ø± ÙƒÙˆØ¯ ØªØ¹ÙˆÙŠØ¶ Ù„Ù„Ø¥Ù„ØºØ§Ø¡ ÙÙŠ ÙˆÙ‚Øª Ù…ØªØ£Ø®Ø±.';
      }
      
      document.getElementById('cancellationPolicy').textContent = policyText;
      document.getElementById('finalCancellationInfo').textContent = policyText;
      
      cancellationStep = 1;
      resetCancellationSteps();
      
      const cancelModal = new bootstrap.Modal(document.getElementById('cancelBookingModal'));
      cancelModal.show();
  }

  function nextCancellationStep() {
      const currentStep = document.getElementById(`step${cancellationStep}`);
      const nextStep = document.getElementById(`step${cancellationStep + 1}`);
      
      if (cancellationStep === 1 && !document.getElementById('confirmCancellation').checked) {
          showToast('ÙŠØ±Ø¬Ù‰ ØªØ£ÙƒÙŠØ¯ Ø±ØºØ¨ØªÙƒ ÙÙŠ Ø§Ù„Ø¥Ù„ØºØ§Ø¡', 'error');
          return;
      }
      
      if (cancellationStep === 2 && !document.getElementById('cancellationReason').value) {
          showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ù„ØºØ§Ø¡', 'error');
          return;
      }
      
      if (currentStep && nextStep) {
          currentStep.classList.remove('active');
          currentStep.style.display = 'none';
          nextStep.classList.add('active');
          nextStep.style.display = 'block';
          cancellationStep++;
      }
      
      if (cancellationStep === 3) {
          document.getElementById('nextCancellationStep').style.display = 'none';
          document.getElementById('confirmCancellationBtn').style.display = 'block';
      }
  }

  function resetCancellationSteps() {
      for (let i = 1; i <= 3; i++) {
          const step = document.getElementById(`step${i}`);
          step.classList.remove('active');
          step.style.display = i === 1 ? 'block' : 'none';
          if (i === 1) step.classList.add('active');
      }
      
      document.getElementById('nextCancellationStep').style.display = 'block';
      document.getElementById('confirmCancellationBtn').style.display = 'none';
      
      document.getElementById('confirmCancellation').checked = false;
      document.getElementById('cancellationReason').value = '';
      document.getElementById('otherReason').style.display = 'none';
      document.getElementById('finalConfirm').checked = false;
  }

  async function confirmCancellation() {
      if (!document.getElementById('finalConfirm').checked) {
          showToast('ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¥Ù„ØºØ§Ø¡', 'error');
          return;
      }

      const reason = document.getElementById('cancellationReason').value === 'Ø¢Ø®Ø±' ? 
                    document.getElementById('otherReason').value : 
                    document.getElementById('cancellationReason').value;

      try {
          const result = await safeFetch(`/api/bookings/${currentCancellationBooking.id}/cancel`, {
              method: 'PUT',
              body: JSON.stringify({
                  cancellationReason: reason
              })
          });

          showToast(result.message, 'success');
          document.getElementById('bookingTracker').style.display = 'none';
          bootstrap.Modal.getInstance(document.getElementById('cancelBookingModal')).hide();
          loadCurrentBookings();
      } catch (error) {
          console.error('Cancellation error:', error);
          showToast(error.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø²', 'error');
      }
  }

  // âœ… Ù†Ø¸Ø§Ù… Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ ÙˆØ§Ù„Ú¤Ø§ÙˆØªØ´Ø±Ø§Øª - Ù…Ø­ÙÙˆØ¸ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
  async function validateVoucher(inputId) {
      const voucherInput = document.getElementById(inputId);
      const voucherCode = voucherInput?.value?.trim();
      
      if (!voucherCode) {
          showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… Ø£ÙˆÙ„Ø§Ù‹', 'error');
          return;
      }

      try {
          const data = await safeFetch('/api/vouchers/validate', {
              method: 'POST',
              body: JSON.stringify({ code: voucherCode })
          });

          if (data.valid) {
              showToast(`âœ… Ø§Ù„ÙƒÙˆØ¯ ØµØ§Ù„Ø­! Ø§Ù„Ø®ØµÙ…: ${data.discount}%`, 'success');
              document.getElementById('voucherResult').textContent = `ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø®ØµÙ… ${data.discount}%`;
          } else {
              showToast('âŒ Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ§Ù„Ø­ Ø£Ùˆ Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©', 'error');
              document.getElementById('voucherResult').textContent = 'Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ§Ù„Ø­';
          }
      } catch (error) {
          console.error('Voucher validation error:', error);
          showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒÙˆØ¯', 'error');
      }
  }

  // âœ… Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© - Ù…Ø­ÙÙˆØ¸ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
  async function loadGoldenSlots() {
      try {
          goldenSlots = await safeFetch('/api/golden-slots');
          updateGoldenSlotsDisplay();
      } catch (error) {
          console.error('Error loading golden slots:', error);
      }
  }

  function updateGoldenSlotsDisplay() {
      goldenSlots.forEach(slot => {
          let timeSlotElement = document.querySelector(`[data-time-slot-id="${slot.id}"]`);

          if (!timeSlotElement && slot.start_time) {
              timeSlotElement = document.querySelector(`[data-hour="${parseInt(slot.start_time)}"]`);
          }

          if (timeSlotElement) {
              timeSlotElement.classList.add('golden');
              timeSlotElement.textContent = `${formatTime(parseInt(slot.start_time || timeSlotElement.dataset.hour))} ğŸ‘¥`;

              if (!timeSlotElement.parentNode.querySelector('.players-request-btn')) {
                  const joinButton = document.createElement('button');
                  joinButton.className = 'btn players-request-btn btn-sm mt-1';
                  joinButton.setAttribute('type', 'button');
                  joinButton.innerHTML = '<i class="bi bi-person-plus me-1"></i>Ø§Ù†Ø¶Ù…';
                  joinButton.onclick = () => showPlayersRequestModal(slot.id);
                  timeSlotElement.parentNode.appendChild(joinButton);
              }
          }
      });
  }

  // âœ… Ù†Ø¸Ø§Ù… Ø·Ù„Ø¨ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† - Ù…Ø­ÙÙˆØ¸ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
  function showPlayersRequestModal(timeSlotId) {
      const slot = goldenSlots.find(s => s.id === timeSlotId);
      if (!slot) return;

      document.getElementById('requestTimeSlotId').value = timeSlotId;
      
      const goldenSlotInfo = document.getElementById('goldenSlotInfo');
      goldenSlotInfo.innerHTML = '';
      
      const lines = [
          `<strong>Ø§Ù„Ù…Ù„Ø¹Ø¨:</strong> ${escapeHtml(slot.stadium_name)}`,
          `<strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ${escapeHtml(slot.date)}`,
          `<strong>Ø§Ù„ÙˆÙ‚Øª:</strong> ${slot.start_time} - ${slot.end_time}`,
          `<strong>Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ÙŠÙ†:</strong> ${slot.players_needed}`
      ];
      
      lines.forEach(line => {
          const div = document.createElement('div');
          div.innerHTML = line;
          goldenSlotInfo.appendChild(div);
      });

      const modal = new bootstrap.Modal(document.getElementById('playersRequestModal'));
      modal.show();
  }

  async function submitPlayersRequest(formData) {
      try {
          const result = await safeFetch('/api/player-requests', {
              method: 'POST',
              body: JSON.stringify(formData)
          });

          showToast(result.message, 'success');
          bootstrap.Modal.getInstance(document.getElementById('playersRequestModal')).hide();
      } catch (error) {
          showToast(error.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨', 'error');
      }
  }

  // ======= ğŸ› ï¸ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© - Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ =======

  function getDefaultPitches() {
      return [
          {
              id: 1,
              name: "Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙŠØ§Ø±Ø© - Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",
              location: "Ø§Ù„Ù…Ù‚Ø·Ù… - Ø´Ø§Ø±Ø¹ Ø§Ù„ØªØ³Ø¹ÙŠÙ†",
              area: "mokatam",
              type: "artificial",
              image: "https://placehold.co/600x400/1a7f46/white?text=Ø§Ù„Ø·ÙŠØ§Ø±Ø©+Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",
              price: 250,
              deposit: 75,
              features: ["Ù†Ø¬ÙŠÙ„Ø© ØµÙ†Ø§Ø¹ÙŠØ©", "ÙƒØ´Ø§ÙØ§Øª Ù„ÙŠÙ„ÙŠØ©", "ØºØ±Ù ØªØ¨Ø¯ÙŠÙ„"],
              rating: 4.7,
              totalRatings: 128,
              googleMaps: "https://maps.app.goo.gl/v6tj8pxhG5FHfoSj9",
              nextAvailableSlot: "Ø§Ù„ÙŠÙˆÙ… 6 Ù…Ø³Ø§Ø¡Ù‹"
          },
          {
              id: 2,
              name: "Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙŠØ§Ø±Ø© - Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ",
              location: "Ø§Ù„Ù…Ù‚Ø·Ù… - Ø´Ø§Ø±Ø¹ Ø§Ù„ØªØ³Ø¹ÙŠÙ†",
              area: "mokatam",
              type: "artificial",
              image: "https://placehold.co/600x400/27ae60/white?text=Ø§Ù„Ø·ÙŠØ§Ø±Ø©+Ø§Ù„Ø«Ø§Ù†ÙŠ",
              price: 220,
              deposit: 66,
              features: ["Ù†Ø¬ÙŠÙ„Ø© ØµÙ†Ø§Ø¹ÙŠØ©", "Ø¥Ø¶Ø§Ø¡Ø© Ù„ÙŠÙ„ÙŠØ©", "ØºØ±Ù ØªØ¨Ø¯ÙŠÙ„"],
              rating: 4.5,
              totalRatings: 95,
              googleMaps: "https://maps.app.goo.gl/v6tj8pxhG5FHfoSj9",
              nextAvailableSlot: "ØºØ¯Ø§Ù‹ 4 Ø¹ØµØ±Ø§Ù‹"
          },
          {
              id: 3,
              name: "Ø§Ù„Ø±Ø§Ø¹ÙŠ Ø§Ù„ØµØ§Ù„Ø­",
              location: "Ø§Ù„Ù…Ù‚Ø·Ù… - Ø´Ø§Ø±Ø¹ 9",
              area: "mokatam",
              type: "natural",
              image: "https://placehold.co/600x400/3498db/white?text=Ø§Ù„Ø±Ø§Ø¹ÙŠ+Ø§Ù„ØµØ§Ù„Ø­",
              price: 300,
              deposit: 90,
              features: ["Ù†Ø¬ÙŠÙ„Ø© Ø·Ø¨ÙŠØ¹ÙŠØ©", "Ù…Ù‚Ø§Ø¹Ø¯ Ø¬Ù…Ø§Ù‡ÙŠØ±", "ÙƒØ§ÙÙŠØªØ±ÙŠØ§"],
              rating: 4.8,
              totalRatings: 156,
              googleMaps: "https://maps.app.goo.gl/hUUReW3ZDQM9wwEj7",
              nextAvailableSlot: "Ø§Ù„ÙŠÙˆÙ… 8 Ù…Ø³Ø§Ø¡Ù‹"
          }
      ];
  }

  function getDefaultStadiums() {
      return getDefaultPitches(); // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙØ³ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  }

  function getDefaultBanners() {
      return [
          {
              id: 1,
              title: "Ø®ØµÙ… 25% Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©",
              description: "Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø®ØµÙ… Ø®Ø§Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø© 8 Ù…Ø³Ø§Ø¡Ù‹",
              image: "https://placehold.co/600x400/667eea/white?text=Ø®ØµÙ…+25%",
              badge: "ğŸ”¥ Ù…Ø­Ø¯ÙˆØ¯",
              ctaText: "Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†",
              ctaAction: "showToast('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©', 'info')"
          },
          {
              id: 2,
              title: "Ù„Ø§Ø¹Ø¨ÙˆÙ†ÙŠ Ù…Ø¹Ø§ÙƒÙ… - Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©",
              description: "Ø§Ù†Ø¶Ù… Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø¬Ø¯ÙŠØ¯Ø© ÙˆØ§Ø¬Ø°Ø¨ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¥Ø¶Ø§ÙÙŠÙŠÙ† Ù„Ù…Ø¨Ø§Ø±Ø§ØªÙƒ",
              image: "https://placehold.co/600x400/764ba2/white?text=Ù„Ø§Ø¹Ø¨ÙˆÙ†ÙŠ+Ù…Ø¹Ø§ÙƒÙ…",
              badge: "ğŸ‘¥ Ø¬Ø¯ÙŠØ¯",
              ctaText: "Ø§ÙƒØªØ´Ù Ø§Ù„Ù…Ø²ÙŠØ¯",
              ctaAction: "window.location.href='/players-with-you'"
          },
          {
              id: 3,
              title: "Ø£Ø¶Ù Ù…Ù„Ø¹Ø¨Ùƒ ÙˆØ²Ø¯ Ø¯Ø®Ù„Ùƒ",
              description: "Ø§Ù†Ø¶Ù… ÙƒØ´Ø±ÙŠÙƒ ÙˆØ§Ø¬Ø¹Ù„ Ù…Ù„Ø¹Ø¨Ùƒ Ù…Ø±Ø¦ÙŠØ§Ù‹ Ù„Ø£Ù„Ø§Ù Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†",
              image: "https://placehold.co/600x400/1a7f46/white?text=Ø£Ø¶Ù+Ù…Ù„Ø¹Ø¨Ùƒ",
              badge: "ğŸŸï¸ Ù„Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨",
              ctaText: "Ø³Ø¬Ù„ Ù…Ù„Ø¹Ø¨Ùƒ",
              ctaAction: "window.location.href='/add-stadium'"
          }
      ];
  }

  function generateStarRating(rating) {
      let stars = '';
      const fullStars = Math.floor(rating);
      const hasHalfStar = rating % 1 >= 0.5;
      
      for (let i = 1; i <= 5; i++) {
          if (i <= fullStars) {
              stars += '<i class="bi bi-star-fill text-warning"></i>';
          } else if (i === fullStars + 1 && hasHalfStar) {
              stars += '<i class="bi bi-star-half text-warning"></i>';
          } else {
              stars += '<i class="bi bi-star text-warning"></i>';
          }
      }
      
      return stars;
  }

  function formatTime(hour) {
      if (hour === 0 || hour === 24) return '12 Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„';
      if (hour === 12) return '12 Ø¸Ù‡Ø±Ø§Ù‹';
      if (hour < 12) return `${hour} ØµØ¨Ø§Ø­Ø§Ù‹`;
      if (hour <= 16) return `${hour - 12} Ø¹ØµØ±Ø§Ù‹`;
      return `${hour - 12} Ù…Ø³Ø§Ø¡Ù‹`;
  }

  function selectTimeSlot(element, stadiumId, hour) {
      const card = element.closest('.stadium-card');
      card.querySelectorAll('.time-slot').forEach(slot => {
          slot.classList.remove('selected');
      });
      
      element.classList.add('selected');
      selectedPitchId = stadiumId;
      selectedTime = hour;
  }

  function viewBookingDetails() {
      if (currentBookings.length > 0) {
          alert(`ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¬Ø²:\nØ§Ù„Ù…Ù„Ø¹Ø¨: ${currentBookings[0].pitchName}\nØ§Ù„ØªØ§Ø±ÙŠØ®: ${currentBookings[0].date}\nØ§Ù„ÙˆÙ‚Øª: ${currentBookings[0].time}\nØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${currentBookings[0].remainingAmount} Ø¬Ù†ÙŠÙ‡`);
      } else {
          showToast('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø¬ÙˆØ²Ø§Øª Ø­Ø§Ù„ÙŠØ©', 'error');
      }
  }

  // ======= ğŸ”§ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© - Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ =======

  async function safeFetch(url, options = {}) {
      const DEFAULT_TIMEOUT = 10000;
      const csrfToken = document.getElementById('csrfToken')?.value || null;

      const controller = new AbortController();
      const id = setTimeout(() => controller.abort(), DEFAULT_TIMEOUT);

      const headers = {
          'Content-Type': 'application/json',
          ...(options.headers || {}),
      };

      if (csrfToken && !(options.method && options.method.toUpperCase() === 'GET')) {
          headers['X-CSRF-Token'] = csrfToken;
      }

      try {
          const res = await fetch(url, {
              credentials: 'same-origin',
              ...options,
              headers,
              signal: controller.signal
          });
          clearTimeout(id);

          const text = await res.text();
          const data = text ? JSON.parse(text) : null;
          
          if (!res.ok) {
              const err = new Error(data?.message || `HTTP ${res.status}`);
              err.status = res.status;
              err.data = data;
              throw err;
          }
          return data;
      } catch (err) {
          clearTimeout(id);
          throw err;
      }
  }

  function escapeHtml(unsafe) {
      return String(unsafe)
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;')
          .replace(/"/g, '&quot;')
          .replace(/'/g, '&#039;');
  }

  function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      toast.className = `toast ${type === 'error' ? 'bg-danger' : 'bg-success'}`;
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => {
          toast.remove();
      }, 3000);
  }

  function debounce(fn, delay = 300) {
      let timer;
      return (...args) => {
          clearTimeout(timer);
          timer = setTimeout(() => fn.apply(this, args), delay);
      };
  }

  // Ø¯ÙˆØ§Ù„ Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ…
  function bookStadium(stadiumId) {
      const token = localStorage.getItem('authToken');
      if (!token) {
          showToast('ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ù„Ø­Ø¬Ø²', 'warning');
          window.location.href = '/login';
          return;
      }

      const daySelector = document.querySelector(`#day-selector-${stadiumId} .day-select`);
      const selectedTimeElement = document.querySelector(`#slots-${stadiumId} .time-slot.selected`);
      
      if (!daySelector || !daySelector.value) {
          showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¬Ø² Ø£ÙˆÙ„Ø§Ù‹', 'error');
          return;
      }

      if (!selectedTimeElement) {
          showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ÙˆÙ‚Øª Ø§Ù„Ø­Ø¬Ø² Ø£ÙˆÙ„Ø§Ù‹', 'error');
          return;
      }

      document.getElementById('pitchId').value = stadiumId;
      document.getElementById('selectedTime').value = selectedTimeElement.dataset.hour;
      document.getElementById('selectedDate').value = daySelector.value;
      
      const bookingModal = new bootstrap.Modal(document.getElementById('bookingModal'));
      bookingModal.show();
  }

  function rateStadium(stadiumId) {
      const ratingModal = new bootstrap.Modal(document.getElementById('ratingModal'));
      ratingModal.show();
  }

  // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
  document.getElementById('bookingForm')?.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const submitBtn = this.querySelector('button[type="submit"]');
      const originalText = submitBtn.innerHTML;
      
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<i class="bi bi-clock me-2"></i>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...';

      try {
          const formData = new FormData(this);
          const data = Object.fromEntries(formData);
          
          const result = await safeFetch('/api/bookings/new', {
              method: 'POST',
              body: JSON.stringify({
                  pitchId: data.pitchId,
                  date: data.selectedDate,
                  time: data.selectedTime,
                  name: data.name,
                  phone: data.phone,
                  email: data.email,
                  playersNeeded: parseInt(data.playersNeeded) || 0,
                  voucherCodes: validatedVouchers.filter(v => v).map(v => v.code),
                  discountCode: data.discountCode
              })
          });

          const bookingStatus = document.getElementById('bookingStatus');
          bookingStatus.innerHTML = '';
          
          const alertDiv = document.createElement('div');
          alertDiv.className = 'alert alert-success';
          
          const icon = document.createElement('i');
          icon.className = 'bi bi-check-circle me-2';
          alertDiv.appendChild(icon);
          alertDiv.appendChild(document.createTextNode(result.message));
          
          bookingStatus.appendChild(alertDiv);
          
          if (parseInt(data.playersNeeded) > 0) {
              await safeFetch(`/api/time-slots/${result.timeSlotId}/make-golden`, {
                  method: 'PUT',
                  body: JSON.stringify({
                      playersNeeded: parseInt(data.playersNeeded)
                  })
              });
          }
          
          setTimeout(() => {
              bootstrap.Modal.getInstance(document.getElementById('bookingModal')).hide();
              if (result.depositAmount > 0) {
                  window.location.href = '/payment?booking=' + result.bookingId;
              } else {
                  showToast('ğŸ‰ ØªÙ… Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                  location.reload();
              }
          }, 2000);
      } catch (error) {
          const bookingStatus = document.getElementById('bookingStatus');
          bookingStatus.innerHTML = '';
          
          const alertDiv = document.createElement('div');
          alertDiv.className = 'alert alert-danger';
          
          const icon = document.createElement('i');
          icon.className = 'bi bi-exclamation-triangle me-2';
          alertDiv.appendChild(icon);
          alertDiv.appendChild(document.createTextNode(error.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…'));
          
          bookingStatus.appendChild(alertDiv);
      } finally {
          submitBtn.disabled = false;
          submitBtn.innerHTML = originalText;
      }
  });

  // Ø¥Ø±Ø³Ø§Ù„ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
  document.getElementById('ratingForm')?.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const formData = new FormData(this);
      const data = Object.fromEntries(formData);
      
      try {
          const result = await safeFetch('/api/ratings', {
              method: 'POST',
              body: JSON.stringify({
                  pitchId: data.pitchId,
                  rating: data.rating,
                  comment: data.comment,
                  bookingId: data.bookingId
              })
          });

          const ratingStatus = document.getElementById('ratingStatus');
          ratingStatus.innerHTML = '';
          
          const alertDiv = document.createElement('div');
          alertDiv.className = 'alert alert-success';
          
          const icon = document.createElement('i');
          icon.className = 'bi bi-check-circle me-2';
          alertDiv.appendChild(icon);
          alertDiv.appendChild(document.createTextNode(result.message));
          
          ratingStatus.appendChild(alertDiv);
          
          setTimeout(() => {
              bootstrap.Modal.getInstance(document.getElementById('ratingModal')).hide();
              fetchStadiums(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
          }, 2000);
      } catch (error) {
          const ratingStatus = document.getElementById('ratingStatus');
          ratingStatus.innerHTML = '';
          
          const alertDiv = document.createElement('div');
          alertDiv.className = 'alert alert-danger';
          
          const icon = document.createElement('i');
          icon.className = 'bi bi-exclamation-triangle me-2';
          alertDiv.appendChild(icon);
          alertDiv.appendChild(document.createTextNode(error.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…'));
          
          ratingStatus.appendChild(alertDiv);
      }
  });

  // Ø¥Ø¹Ø¯Ø§Ø¯ Ù†Ù…ÙˆØ°Ø¬ Ø·Ù„Ø¨ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
  document.getElementById('playersRequestForm')?.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const formData = {
          timeSlotId: parseInt(document.getElementById('requestTimeSlotId').value),
          requesterName: document.getElementById('requesterName').value,
          requesterAge: parseInt(document.getElementById('requesterAge').value),
          comment: document.getElementById('requestComment').value,
          playersCount: parseInt(document.getElementById('playersWithYou').value)
      };

      await submitPlayersRequest(formData);
  });

  // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†ØªÙ‚ÙŠ Ø§Ù„Ø£ÙŠØ§Ù…
  function createDaySelector(stadiumId) {
      const daysContainer = document.createElement('div');
      
      const label = document.createElement('label');
      label.className = 'form-label';
      label.textContent = 'Ø§Ø®ØªØ± ÙŠÙˆÙ… Ø§Ù„Ø­Ø¬Ø²:';
      daysContainer.appendChild(label);

      const select = document.createElement('select');
      select.className = 'form-select day-select';
      select.onchange = () => loadStadiumSlots(stadiumId, select.value);

      const defaultOption = document.createElement('option');
      defaultOption.value = '';
      defaultOption.textContent = 'Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…';
      select.appendChild(defaultOption);

      const today = new Date();
      const dayNames = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Ø§Ù„Ø³Ø¨Øª'];
      const monthNames = ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ', 'ÙŠÙˆÙ„ÙŠÙˆ', 'Ø£ØºØ³Ø·Ø³', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'];
      
      for (let i = 0; i < 7; i++) {
          const date = new Date();
          date.setDate(today.getDate() + i);
          
          const option = document.createElement('option');
          option.value = date.toISOString().split('T')[0];
          option.textContent = `${i === 0 ? 'Ø§Ù†Ù‡Ø±Ø¯Ù‡' : dayNames[date.getDay()]} - ${date.getDate()} ${monthNames[date.getMonth()]}`;
          select.appendChild(option);
      }

      daysContainer.appendChild(select);
      return daysContainer;
  }

  // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
  async function loadStadiumSlots(stadiumId, date) {
      try {
          const data = await safeFetch(`/api/stadiums/${stadiumId}/available-slots?date=${date}`);
          
          const slotsContainer = document.getElementById(`slots-${stadiumId}`);
          slotsContainer.innerHTML = '';
          
          if (!data || !data.availableSlots || data.availableSlots.length === 0) {
              const message = document.createElement('p');
              message.className = 'text-danger text-center';
              message.textContent = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ÙˆÙ‚Ø§Øª Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ§Ø±ÙŠØ®';
              slotsContainer.appendChild(message);
              return;
          }
          
          data.availableSlots.forEach(slot => {
              const slotElement = document.createElement('div');
              slotElement.className = 'time-slot available';
              slotElement.setAttribute('role', 'button');
              slotElement.setAttribute('tabindex', '0');
              slotElement.dataset.hour = slot.hour || slot.start_time;
              slotElement.textContent = formatTime(slot.hour || slot.start_time);

              slotElement.addEventListener('click', () => selectTimeSlot(slotElement, stadiumId, slot.hour || slot.start_time));
              slotElement.addEventListener('keydown', (e) => {
                  if (e.key === 'Enter' || e.key === ' ') {
                      e.preventDefault();
                      selectTimeSlot(slotElement, stadiumId, slot.hour || slot.start_time);
                  }
              });

              slotsContainer.appendChild(slotElement);
          });
          
      } catch (error) {
          console.error('Error loading slots:', error);
          const slotsContainer = document.getElementById(`slots-${stadiumId}`);
          slotsContainer.innerHTML = '<p class="text-danger text-center">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª</p>';
      }
  }

  // Ø¯ÙˆØ§Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
  function loadPitches(pitchesData) {
      // Ø¯Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ… - Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù„ØªÙˆØ§ÙÙ‚
      console.log('Loading pitches:', pitchesData);
  }

  function bookPitch(pitchId, hour) {
      // Ø¯Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ… - Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù„ØªÙˆØ§ÙÙ‚
      bookStadium(pitchId);
  }

  function startCountdown(bookingId) {
      // Ø¯Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ… - Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù„ØªÙˆØ§ÙÙ‚
      console.log('Starting countdown for booking:', bookingId);
  }

  // ======= ğŸ¯ Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© =======

  document.addEventListener('DOMContentLoaded', function() {
      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
      fetchStadiums();
      
      // ğŸ†• ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø§Ù†Ø±Ø²
      fetchBanners();
      
      // ğŸ†• ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…Ù…ÙŠØ²Ø©
      fetchFeaturedStadiums();
      
      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©
      loadGoldenSlots();
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      checkUserPermissions();
      
      // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙÙ„Ø§ØªØ±
      const debouncedFilter = debounce(filterStadiums, 300);
      document.getElementById('areaFilter').addEventListener('change', debouncedFilter);
      document.getElementById('sortFilter').addEventListener('change', debouncedFilter);
      document.getElementById('typeFilter').addEventListener('change', debouncedFilter);
      document.getElementById('priceFilter').addEventListener('change', debouncedFilter);
      document.getElementById('ratingFilter').addEventListener('change', debouncedFilter);
      document.getElementById('availabilityFilter').addEventListener('change', debouncedFilter);
      document.getElementById('searchStadiums').addEventListener('input', debouncedFilter);
      
      // Ø¬Ù„Ø¨ Ø±Ù…Ø² CSRF
      safeFetch('/csrf-token')
          .then(data => {
              if (data?.csrfToken) {
                  document.getElementById('csrfToken').value = data.csrfToken;
                  document.getElementById('ratingCsrfToken').value = data.csrfToken;
              }
          })
          .catch(err => console.error('CSRF token error:', err));

      // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ØªÙ…Ø±ÙŠØ±
      window.addEventListener('scroll', function() {
          if (window.scrollY > 100) {
              document.querySelector('.navbar').classList.add('scrolled');
          } else {
              document.querySelector('.navbar').classList.remove('scrolled');
          }

          document.querySelectorAll('section').forEach(sec => {
              let top = window.scrollY;
              if(top >= sec.offsetTop - 200){
                  document.querySelectorAll('.nav-link').forEach(a => a.classList.remove('active'));
                  document.querySelector(`.nav-link[href="#${sec.id}"]`)?.classList.add('active');
              }
          });

          document.getElementById('toTop').style.display = window.scrollY > 200 ? 'block' : 'none';
      });

      // Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø£Ø¹Ù„Ù‰
      document.getElementById('toTop').onclick = () => {
          window.scrollTo({ top: 0, behavior: 'smooth' });
      };

      // Ø¥Ø¹Ø¯Ø§Ø¯ Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ù„ØºØ§Ø¡
      document.getElementById('cancellationReason').addEventListener('change', function() {
          const otherReason = document.getElementById('otherReason');
          otherReason.style.display = this.value === 'Ø¢Ø®Ø±' ? 'block' : 'none';
      });

      // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
      window.addEventListener('load', () => {
          setTimeout(() => {
              document.getElementById('loadingOverlay').classList.add('fade-out');
          }, 1000);
      });

      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
      setInterval(loadGoldenSlots, 60000);

      // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù†Ø¬ÙˆÙ… ÙÙŠ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
      document.querySelectorAll('#ratingStars .star').forEach(star => {
          star.addEventListener('click', function() {
              const rating = parseInt(this.dataset.rating);
              document.getElementById('selectedRating').value = rating;
              
              document.querySelectorAll('#ratingStars .star').forEach(s => {
                  const starRating = parseInt(s.dataset.rating);
                  if (starRating <= rating) {
                      s.classList.add('active', 'bi-star-fill');
                      s.classList.remove('bi-star');
                      s.setAttribute('aria-checked', 'true');
                  } else {
                      s.classList.remove('active', 'bi-star-fill');
                      s.classList.add('bi-star');
                      s.setAttribute('aria-checked', 'false');
                  }
              });
          });
      });
  });

  function checkUserPermissions() {
      const token = localStorage.getItem('authToken');
      const userRole = localStorage.getItem('userRole');
      
      if (token && (userRole === 'owner' || userRole === 'admin')) {
          document.getElementById('addStadiumNavItem').style.display = 'block';
          document.getElementById('addStadiumHeroBtn').style.display = 'block';
      }
  }

  // ğŸ†• Ø¯Ø§Ù„Ø© Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
  function filterStadiums() {
      const area = document.getElementById('areaFilter').value;
      const sort = document.getElementById('sortFilter').value;
      const type = document.getElementById('typeFilter').value;
      const price = document.getElementById('priceFilter').value;
      const rating = document.getElementById('ratingFilter').value;
      const availability = document.getElementById('availabilityFilter').value;
      const search = document.getElementById('searchStadiums').value.toLowerCase();
      
      showToast('Ø¬Ø§Ø±ÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ±Ø©...', 'info');
      
      // Ù‡Ù†Ø§ Ø³ÙŠØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©
      // Ù‡Ø°Ù‡ Ø¯Ø§Ù„Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© - ÙŠÙ…ÙƒÙ† ØªØ·ÙˆÙŠØ±Ù‡Ø§ Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø©
      console.log('Applying filters:', { area, sort, type, price, rating, availability, search });
  }

  // ğŸ†• Ø¯ÙˆØ§Ù„ Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  function startVoiceRating() {
      const recognition = initVoiceRating();
      if (recognition) {
          recognition.start();
          showToast('ğŸ¤ Ø§Ù„ØªØ­Ø¯Ø« Ø§Ù„Ø¢Ù†...', 'info');
      } else {
          showToast('Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ', 'error');
      }
  }

  function submitAdvancedRating() {
      showToast('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ØªÙ‚Ø¯Ù…', 'success');
      bootstrap.Modal.getInstance(document.getElementById('advancedRatingModal')).hide();
  }

  function shareStadiumReview() {
      showToast('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©', 'success');
  }

  function initVoiceRecognition() {
      // ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ
      if ('webkitSpeechRecognition' in window) {
          console.log('Voice recognition supported');
      }
  }

  // ğŸ†• Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø§Ù†Ø±Ø²
  async function fetchBanners() {
      try {
          const banners = await loadBanners();
          renderBanners(banners);
      } catch (err) {
          console.error('Error fetching banners:', err);
          renderDefaultBanners();
      }
  }

  function renderBanners(banners) {
      const container = document.getElementById('bannersContainer');
      if (!Array.isArray(banners) || banners.length === 0) {
          renderDefaultBanners();
          return;
      }

      container.innerHTML = banners.map(banner => `
          <div class="col-md-4 mb-3">
              <div class="banner-card">
                  <div class="banner-image" style="background-image: url('${banner.image || 'https://placehold.co/600x400/667eea/white?text=Ø¹Ø±Ø¶+Ø®Ø§Øµ'}')">
                      ${banner.badge ? `<span class="banner-badge">${banner.badge}</span>` : ''}
                  </div>
                  <div class="banner-content">
                      <h5>${escapeHtml(banner.title)}</h5>
                      <p class="text-muted">${escapeHtml(banner.description)}</p>
                      ${banner.ctaText ? `
                          <button class="btn btn-primary w-100" onclick="${banner.ctaAction || 'showToast(\\'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡...\\', \\'info\\')'}">
                              ${banner.ctaText}
                          </button>
                      ` : ''}
                  </div>
              </div>
          </div>
      `).join('');
  }

  function renderDefaultBanners() {
      const container = document.getElementById('bannersContainer');
      container.innerHTML = `
          <div class="col-md-4 mb-3">
              <div class="banner-card">
                  <div class="banner-image" style="background-image: url('https://placehold.co/600x400/667eea/white?text=Ø®ØµÙ…+25%')">
                      <span class="banner-badge">ğŸ”¥ Ù…Ø­Ø¯ÙˆØ¯</span>
                  </div>
                  <div class="banner-content">
                      <h5>Ø®ØµÙ… 25% Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©</h5>
                      <p class="text-muted">Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø®ØµÙ… Ø®Ø§Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø© 8 Ù…Ø³Ø§Ø¡Ù‹</p>
                      <button class="btn btn-primary w-100" onclick="showToast('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©', 'info')">
                          Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†
                      </button>
                  </div>
              </div>
          </div>
          <div class="col-md-4 mb-3">
              <div class="banner-card">
                  <div class="banner-image" style="background-image: url('https://placehold.co/600x400/764ba2/white?text=Ù„Ø§Ø¹Ø¨ÙˆÙ†ÙŠ+Ù…Ø¹Ø§ÙƒÙ…')">
                      <span class="banner-badge">ğŸ‘¥ Ø¬Ø¯ÙŠØ¯</span>
                  </div>
                  <div class="banner-content">
                      <h5>Ù„Ø§Ø¹Ø¨ÙˆÙ†ÙŠ Ù…Ø¹Ø§ÙƒÙ… - Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©</h5>
                      <p class="text-muted">Ø§Ù†Ø¶Ù… Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø¬Ø¯ÙŠØ¯Ø© ÙˆØ§Ø¬Ø°Ø¨ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¥Ø¶Ø§ÙÙŠÙŠÙ† Ù„Ù…Ø¨Ø§Ø±Ø§ØªÙƒ</p>
                      <button class="btn btn-primary w-100" onclick="window.location.href='/players-with-you'">
                          Ø§ÙƒØªØ´Ù Ø§Ù„Ù…Ø²ÙŠØ¯
                      </button>
                  </div>
              </div>
          </div>
          <div class="col-md-4 mb-3">
              <div class="banner-card">
                  <div class="banner-image" style="background-image: url('https://placehold.co/600x400/1a7f46/white?text=Ø£Ø¶Ù+Ù…Ù„Ø¹Ø¨Ùƒ')">
                      <span class="banner-badge">ğŸŸï¸ Ù„Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨</span>
                  </div>
                  <div class="banner-content">
                      <h5>Ø£Ø¶Ù Ù…Ù„Ø¹Ø¨Ùƒ ÙˆØ²Ø¯ Ø¯Ø®Ù„Ùƒ</h5>
                      <p class="text-muted">Ø§Ù†Ø¶Ù… ÙƒØ´Ø±ÙŠÙƒ ÙˆØ§Ø¬Ø¹Ù„ Ù…Ù„Ø¹Ø¨Ùƒ Ù…Ø±Ø¦ÙŠØ§Ù‹ Ù„Ø£Ù„Ø§Ù Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</p>
                      <button class="btn btn-primary w-100" onclick="window.location.href='/add-stadium'">
                          Ø³Ø¬Ù„ Ù…Ù„Ø¹Ø¨Ùƒ
                      </button>
                  </div>
              </div>
          </div>
      `;
  }

  // ğŸ†• Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…Ù…ÙŠØ²Ø©
  async function fetchFeaturedStadiums() {
      try {
          const stadiums = await loadFeaturedStadiums();
          renderFeaturedStadiums(stadiums);
      } catch (err) {
          console.error('Error fetching featured stadiums:', err);
      }
  }

  function renderFeaturedStadiums(stadiums) {
      const container = document.getElementById('featuredStadiumsContainer');
      if (!Array.isArray(stadiums) || stadiums.length === 0) {
          container.innerHTML = '<div class="col-12 text-center"><p class="text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø¹Ø¨ Ù…Ù…ÙŠØ²Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</p></div>';
          return;
      }

      container.innerHTML = stadiums.map(st => {
          const img = (st.images && st.images.length) ? st.images[0] : 'https://placehold.co/600x400/1a7f46/white?text=Ù…Ù„Ø¹Ø¨+Ù…Ù…ÙŠØ²';
          const nextSlot = st.nextAvailableSlot ? 
              `<div class="next-slot-badge">
                 <i class="bi bi-clock"></i> Ø§Ù„ØªØ§Ù„ÙŠ: ${st.nextAvailableSlot}
               </div>` : '';

          return `
              <div class="col-lg-4 col-md-6 mb-4">
                  <div class="stadium-card h-100">
                      <div class="stadium-image" style="background-image: url('${img}')" loading="lazy">
                          <span class="featured-badge">â­ Ù…Ù…ÙŠØ²</span>
                          <span class="stadium-badge availability-high">Ø§Ù„Ø£ÙƒØ«Ø± Ø·Ù„Ø¨Ø§Ù‹</span>
                          <span class="stadium-price">${st.price ? st.price + ' Ø¬.Ù…/Ø³Ø§Ø¹Ø©' : '-'}</span>
                      </div>
                      <div class="stadium-info">
                          <h4 class="stadium-title">${escapeHtml(st.name)}</h4>
                          <p class="stadium-location">
                              <i class="bi bi-geo-alt"></i> ${escapeHtml(st.location || 'Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…Ø­Ø¯Ø¯')}
                          </p>
                          
                          ${nextSlot}
                          
                          <div class="d-flex justify-content-between align-items-center mb-3">
                              <div>
                                  <div class="rating-stars">
                                      ${generateStarRating(st.rating || 4.5)}
                                  </div>
                                  <div class="rating-text">${(st.rating || 4.5).toFixed(1)} (${st.totalRatings || 0} ØªÙ‚ÙŠÙŠÙ…)</div>
                              </div>
                          </div>

                          <button class="btn btn-primary w-100" onclick="bookStadium(${st.id})">
                              <i class="bi bi-credit-card me-2"></i>Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†
                          </button>
                      </div>
                  </div>
              </div>`;
      }).join('');
  }
</script>
  // ======= ğŸ”§ Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù†Ø§Ù‚ØµØ© =======
function getDefaultStadiums() {
    return [
        {
            id: 1,
            name: "Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙŠØ§Ø±Ø© - Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",
            location: "Ø§Ù„Ù…Ù‚Ø·Ù… - Ø´Ø§Ø±Ø¹ Ø§Ù„ØªØ³Ø¹ÙŠÙ†",
            price: 250,
            deposit: 75,
            features: ["Ù†Ø¬ÙŠÙ„Ø© ØµÙ†Ø§Ø¹ÙŠØ©", "ÙƒØ´Ø§ÙØ§Øª Ù„ÙŠÙ„ÙŠØ©"],
            rating: 4.7,
            availabilityPercentage: 80,
            nextAvailableSlot: "Ø§Ù„ÙŠÙˆÙ… 6 Ù…Ø³Ø§Ø¡Ù‹",
            image: "https://placehold.co/600x400/1a7f46/white?text=Ù…Ù„Ø¹Ø¨+1"
        },
        {
            id: 2,
            name: "Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙŠØ§Ø±Ø© - Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ", 
            location: "Ø§Ù„Ù…Ù‚Ø·Ù… - Ø´Ø§Ø±Ø¹ Ø§Ù„ØªØ³Ø¹ÙŠÙ†",
            price: 220,
            deposit: 66,
            features: ["Ù†Ø¬ÙŠÙ„Ø© ØµÙ†Ø§Ø¹ÙŠØ©", "Ø¥Ø¶Ø§Ø¡Ø© Ù„ÙŠÙ„ÙŠØ©"],
            rating: 4.5,
            availabilityPercentage: 60,
            nextAvailableSlot: "ØºØ¯Ø§Ù‹ 4 Ø¹ØµØ±Ø§Ù‹",
            image: "https://placehold.co/600x400/27ae60/white?text=Ù…Ù„Ø¹Ø¨+2"
        }
    ];
}

function getDefaultBanners() {
    return [
        {
            id: 1,
            title: "Ø®ØµÙ… 25% Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©",
            description: "Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø®ØµÙ… Ø®Ø§Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©",
            image: "https://placehold.co/600x400/667eea/white?text=Ø¹Ø±Ø¶+Ø®Ø§Øµ",
            badge: "Ø¹Ø±Ø¶ Ù…Ø­Ø¯ÙˆØ¯"
        }
    ];
}

// ======= ğŸ¯ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø¹Ø¯Ù„Ø© =======
async function initializeApp() {
    try {
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø´ÙƒÙ„ Ù…ØªÙˆØ§Ø²ÙŠ
        await Promise.all([
            fetchStadiums(),
            fetchBanners(), 
            fetchFeaturedStadiums()
        ]);

        // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ©
        setTimeout(() => {
            const loadingOverlay = document.getElementById('loadingOverlay');
            if (loadingOverlay) {
                loadingOverlay.classList.add('fade-out');
            }
        }, 1000);
        
    } catch (error) {
        console.error('App initialization error:', error);
        const loadingOverlay = document.getElementById('loadingOverlay');
        if (loadingOverlay) {
            loadingOverlay.classList.add('fade-out');
        }
    }
}

// ======= ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© =======
let selectedPitchId = null;
let selectedTime = '';

async function fetchStadiums() {
    try {
        const stadiums = await loadStadiums();
        renderStadiums(stadiums);
    } catch (err) {
        console.error('Error fetching stadiums:', err);
        const defaultStadiums = getDefaultStadiums();
        renderStadiums(defaultStadiums);
    }
}

async function fetchBanners() {
    try {
        const banners = await loadBanners();
        renderBanners(banners);
    } catch (err) {
        console.error('Error fetching banners:', err);
        renderDefaultBanners();
    }
}

async function fetchFeaturedStadiums() {
    try {
        const stadiums = await loadFeaturedStadiums();
        renderFeaturedStadiums(stadiums);
    } catch (err) {
        console.error('Error fetching featured stadiums:', err);
    }
}

// ======= ğŸ¨ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ø±Ø¶ =======
function renderStadiums(stadiums) {
    const container = document.getElementById('stadiumsContainer');
    if (!container) return;
    
    if (!Array.isArray(stadiums) || stadiums.length === 0) {
        container.innerHTML = '<div class="col-12 text-center"><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø¹Ø¨ Ù…ØªØ§Ø­Ø©</p></div>';
        return;
    }

    container.innerHTML = stadiums.map(stadium => `
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="stadium-card">
                <div class="stadium-image" style="background-image: url('${stadium.image}')">
                    <span class="stadium-badge">Ù…ØªØ§Ø­</span>
                    <span class="stadium-price">${stadium.price} Ø¬.Ù…/Ø³Ø§Ø¹Ø©</span>
                </div>
                <div class="stadium-info">
                    <h4 class="stadium-title">${stadium.name}</h4>
                    <p class="stadium-location">${stadium.location}</p>
                    <button class="btn btn-primary w-100" onclick="bookStadium(${stadium.id})">
                        Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†
                    </button>
                </div>
            </div>
        </div>
    `).join('');
}

function renderBanners(banners) {
    const container = document.getElementById('bannersContainer');
    if (!container) return;
    
    container.innerHTML = banners.map(banner => `
        <div class="col-md-4 mb-3">
            <div class="banner-card">
                <div class="banner-image" style="background-image: url('${banner.image}')">
                    <span class="banner-badge">${banner.badge}</span>
                </div>
                <div class="banner-content">
                    <h5>${banner.title}</h5>
                    <p>${banner.description}</p>
                </div>
            </div>
        </div>
    `).join('');
}

function renderFeaturedStadiums(stadiums) {
    const container = document.getElementById('featuredStadiumsContainer');
    if (!container) return;
    
    container.innerHTML = stadiums.map(stadium => `
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="stadium-card">
                <div class="stadium-image" style="background-image: url('${stadium.image}')">
                    <span class="featured-badge">Ù…Ù…ÙŠØ²</span>
                    <span class="stadium-price">${stadium.price} Ø¬.Ù…/Ø³Ø§Ø¹Ø©</span>
                </div>
                <div class="stadium-info">
                    <h4 class="stadium-title">${stadium.name}</h4>
                    <p class="stadium-location">${stadium.location}</p>
                    <button class="btn btn-primary w-100" onclick="bookStadium(${stadium.id})">
                        Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†
                    </button>
                </div>
            </div>
        </div>
    `).join('');
}

// ======= ğŸ¯ Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© =======
function bookStadium(stadiumId) {
    showToast(`Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø­Ø¬Ø² Ø§Ù„Ù…Ù„Ø¹Ø¨ ${stadiumId}`, 'info');
    // ÙŠÙ…ÙƒÙ† ÙØªØ­ Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø­Ø¬Ø² Ù‡Ù†Ø§
}

function showToast(message, type = 'info') {
    // ØªÙ†ÙÙŠØ° Ø¨Ø³ÙŠØ· Ù„Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
    alert(message);
}

// ======= ğŸš€ Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© =======
document.addEventListener('DOMContentLoaded', function() {
    initializeApp();
});
  
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
// ======= ğŸ¯ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© =======
let currentStadiums = [];
let selectedStadiumId = null;
let selectedTime = '';
let selectedDate = '';

// ======= ğŸš€ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© =======

// 1. Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
function initializeApp() {
    console.log('ğŸš€ Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚...');
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
    initTheme();
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠÙ† Ù„Ù„Ø£Ø­Ø¯Ø§Ø«
    initEventListeners();
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    loadInitialData();
    
    // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
    setTimeout(() => {
        const loadingOverlay = document.getElementById('loadingOverlay');
        if (loadingOverlay) {
            loadingOverlay.classList.add('fade-out');
            console.log('âœ… ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„');
        }
    }, 2000);
}

// 2. ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
function loadInitialData() {
    console.log('ğŸ“¥ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...');
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨
    loadStadiums();
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙÙ„Ø§ØªØ±
    setupFilters();
}

// 3. ØªØ­Ù…ÙŠÙ„ ÙˆØ¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨
function loadStadiums(filters = {}) {
    console.log('ğŸŸï¸ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨...');
    
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„Ù…Ù„Ø§Ø¹Ø¨
    const stadiums = [
        {
            id: 1,
            name: "Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙŠØ§Ø±Ø© - Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",
            location: "Ø§Ù„Ù…Ù‚Ø·Ù… - Ø´Ø§Ø±Ø¹ Ø§Ù„ØªØ³Ø¹ÙŠÙ†",
            area: "mokatam",
            price: 250,
            deposit: 75,
            image: "https://images.unsplash.com/photo-1575361204480-aadea25e6e68?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80",
            features: ["Ù†Ø¬ÙŠÙ„Ø© ØµÙ†Ø§Ø¹ÙŠØ©", "ÙƒØ´Ø§ÙØ§Øª Ù„ÙŠÙ„ÙŠØ©", "ØºØ±Ù ØªØ¨Ø¯ÙŠÙ„"],
            rating: 4.7,
            totalRatings: 128,
            availabilityPercentage: 80
        },
        {
            id: 2,
            name: "Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø·ÙŠØ§Ø±Ø© - Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ",
            location: "Ø§Ù„Ù…Ù‚Ø·Ù… - Ø´Ø§Ø±Ø¹ Ø§Ù„ØªØ³Ø¹ÙŠÙ†",
            area: "mokatam",
            price: 220,
            deposit: 66,
            image: "https://images.unsplash.com/photo-1529900748604-07564a03e7a6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80",
            features: ["Ù†Ø¬ÙŠÙ„Ø© ØµÙ†Ø§Ø¹ÙŠØ©", "Ø¥Ø¶Ø§Ø¡Ø© Ù„ÙŠÙ„ÙŠØ©", "ØºØ±Ù ØªØ¨Ø¯ÙŠÙ„"],
            rating: 4.5,
            totalRatings: 95,
            availabilityPercentage: 60
        },
        {
            id: 3,
            name: "Ø§Ù„Ø±Ø§Ø¹ÙŠ Ø§Ù„ØµØ§Ù„Ø­",
            location: "Ø§Ù„Ù…Ù‚Ø·Ù… - Ø´Ø§Ø±Ø¹ 9",
            area: "mokatam",
            price: 300,
            deposit: 90,
            image: "https://images.unsplash.com/photo-1543353072-4cf8a2d6a6e6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80",
            features: ["Ù†Ø¬ÙŠÙ„Ø© Ø·Ø¨ÙŠØ¹ÙŠØ©", "Ù…Ù‚Ø§Ø¹Ø¯ Ø¬Ù…Ø§Ù‡ÙŠØ±", "ÙƒØ§ÙÙŠØªØ±ÙŠØ§"],
            rating: 4.8,
            totalRatings: 156,
            availabilityPercentage: 40
        }
    ];
    
    currentStadiums = stadiums;
    renderStadiums(stadiums);
    showToast('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
}

// 4. Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
function renderStadiums(stadiums) {
    console.log('ğŸ¨ Ø¬Ø§Ø±ÙŠ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨...');
    
    const container = document.getElementById('stadiumsContainer');
    if (!container) {
        console.error('âŒ Ø¹Ù†ØµØ± stadiumsContainer ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
        return;
    }
    
    if (!stadiums || stadiums.length === 0) {
        container.innerHTML = `
            <div class="col-12 text-center py-5">
                <i class="bi bi-search display-1 text-muted"></i>
                <h4 class="text-muted mt-3">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø¹Ø¨ Ù…ØªØ§Ø­Ø©</h4>
            </div>
        `;
        return;
    }
    
    container.innerHTML = stadiums.map(stadium => `
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="stadium-card h-100">
                <div class="stadium-image" style="background-image: url('${stadium.image}')">
                    <span class="stadium-badge ${getAvailabilityClass(stadium.availabilityPercentage)}">
                        ${getAvailabilityText(stadium.availabilityPercentage)}
                    </span>
                    <span class="stadium-price">${stadium.price} Ø¬.Ù…/Ø³Ø§Ø¹Ø©</span>
                </div>
                <div class="stadium-info">
                    <h4 class="stadium-title">${stadium.name}</h4>
                    <p class="text-muted mb-3">
                        <i class="bi bi-geo-alt"></i> ${stadium.location}
                    </p>
                    
                    <div class="rating-stars mb-2">
                        ${generateStarRating(stadium.rating)}
                    </div>
                    <small class="text-muted">${stadium.rating.toFixed(1)} (${stadium.totalRatings} ØªÙ‚ÙŠÙŠÙ…)</small>
                    
                    <div class="mt-3">
                        ${stadium.features.map(feature => 
                            `<span class="badge bg-light text-dark me-1 mb-1">${feature}</span>`
                        ).join('')}
                    </div>
                    
                    <div class="days-selector mt-3" id="day-selector-${stadium.id}"></div>
                    
                    <div class="time-slots-container mt-2" id="slots-${stadium.id}">
                        <p class="text-muted text-center">Ø§Ø®ØªØ± ÙŠÙˆÙ…Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</p>
                    </div>
                    
                    <button class="btn btn-primary w-100 mt-3" onclick="showBookingModal(${stadium.id})">
                        <i class="bi bi-credit-card me-2"></i>Ø§Ø­Ø¬Ø² ÙˆØ§Ø¯ÙØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†
                    </button>
                </div>
            </div>
        </div>
    `).join('');
    
    // Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªÙ‚ÙŠ Ø§Ù„Ø£ÙŠØ§Ù… Ù„ÙƒÙ„ Ù…Ù„Ø¹Ø¨
    stadiums.forEach(stadium => {
        createDaySelector(stadium.id);
    });
    
    console.log(`âœ… ØªÙ… Ø¹Ø±Ø¶ ${stadiums.length} Ù…Ù„Ø¹Ø¨`);
}

// 5. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†ØªÙ‚ÙŠ Ø§Ù„Ø£ÙŠØ§Ù…
function createDaySelector(stadiumId) {
    const container = document.getElementById(`day-selector-${stadiumId}`);
    if (!container) return;
    
    const select = document.createElement('select');
    select.className = 'form-select';
    select.innerHTML = `
        <option value="">Ø§Ø®ØªØ± ÙŠÙˆÙ… Ø§Ù„Ø­Ø¬Ø²</option>
        <option value="today">Ø§Ù„ÙŠÙˆÙ…</option>
        <option value="tomorrow">ØºØ¯Ø§Ù‹</option>
        <option value="day-after-tomorrow">Ø¨Ø¹Ø¯ ØºØ¯</option>
    `;
    
    select.addEventListener('change', function() {
        loadTimeSlots(stadiumId, this.value);
    });
    
    container.appendChild(select);
}

// 6. ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
function loadTimeSlots(stadiumId, date) {
    const container = document.getElementById(`slots-${stadiumId}`);
    if (!container) return;
    
    if (!date) {
        container.innerHTML = '<p class="text-muted text-center">Ø§Ø®ØªØ± ÙŠÙˆÙ…Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</p>';
        return;
    }
    
    // Ø£ÙˆÙ‚Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
    const timeSlots = [
        { time: '16:00', available: true },
        { time: '18:00', available: true },
        { time: '20:00', available: true },
        { time: '22:00', available: false }
    ];
    
    container.innerHTML = timeSlots.map(slot => `
        <div class="time-slot ${slot.available ? 'available' : 'booked'}" 
             onclick="${slot.available ? `selectTimeSlot(this, ${stadiumId}, '${slot.time}')` : ''}"
             style="${!slot.available ? 'cursor: not-allowed; opacity: 0.5;' : ''}">
            ${slot.time}
            ${!slot.available ? ' (Ù…Ø­Ø¬ÙˆØ²)' : ''}
        </div>
    `).join('');
}

// 7. Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙˆÙ‚Øª
function selectTimeSlot(element, stadiumId, time) {
    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
    const container = element.parentElement;
    container.querySelectorAll('.time-slot').forEach(slot => {
        slot.classList.remove('selected');
    });
    
    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ø®ØªØ§Ø±
    element.classList.add('selected');
    
    selectedStadiumId = stadiumId;
    selectedTime = time;
    
    console.log(`âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙˆÙ‚Øª: ${time} Ù„Ù„Ù…Ù„Ø¹Ø¨: ${stadiumId}`);
}

// 8. Ø¹Ø±Ø¶ Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø­Ø¬Ø²
function showBookingModal(stadiumId) {
    if (!selectedTime) {
        showToast('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ÙˆÙ‚Øª Ø§Ù„Ø­Ø¬Ø² Ø£ÙˆÙ„Ø§Ù‹', 'warning');
        return;
    }
    
    const stadium = currentStadiums.find(s => s.id === stadiumId);
    if (!stadium) return;
    
    // ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¬Ø²
    document.getElementById('pitchId').value = stadiumId;
    document.getElementById('selectedTime').value = selectedTime;
    
    const bookingDetails = document.getElementById('bookingDetails');
    bookingDetails.innerHTML = `
        <div class="alert alert-info">
            <h6>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¬Ø²:</h6>
            <p class="mb-1"><strong>Ø§Ù„Ù…Ù„Ø¹Ø¨:</strong> ${stadium.name}</p>
            <p class="mb-1"><strong>Ø§Ù„ÙˆÙ‚Øª:</strong> ${selectedTime}</p>
            <p class="mb-0"><strong>Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†:</strong> ${stadium.deposit} Ø¬.Ù…</p>
        </div>
    `;
    
    // Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
    const modal = new bootstrap.Modal(document.getElementById('bookingModal'));
    modal.show();
}

// 9. Ù…Ø¹Ø§Ù„Ø¬Ø© Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø­Ø¬Ø²
document.getElementById('bookingForm')?.addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const name = formData.get('name');
    const phone = formData.get('phone');
    const stadiumId = formData.get('pitchId');
    
    if (!name || !phone) {
        showToast('âš ï¸ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', 'warning');
        return;
    }
    
    // Ù…Ø­Ø§ÙƒØ§Ø© Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø­Ø¬Ø²
    const submitBtn = this.querySelector('button[type="submit"]');
    const originalText = submitBtn.innerHTML;
    
    submitBtn.disabled = true;
    submitBtn.innerHTML = '<i class="bi bi-clock me-2"></i>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...';
    
    setTimeout(() => {
        showToast('ğŸ‰ ØªÙ… Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­! Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹', 'success');
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
        const modal = bootstrap.Modal.getInstance(document.getElementById('bookingModal'));
        modal.hide();
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        this.reset();
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalText;
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª
        selectedStadiumId = null;
        selectedTime = '';
        selectedDate = '';
        
    }, 2000);
});

// ======= ğŸ¨ Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© =======

// 1. ØªÙˆÙ„ÙŠØ¯ Ù†Ø¬ÙˆÙ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
function generateStarRating(rating) {
    let stars = '';
    const fullStars = Math.floor(rating);
    const hasHalfStar = rating % 1 >= 0.5;
    
    for (let i = 1; i <= 5; i++) {
        if (i <= fullStars) {
            stars += '<i class="bi bi-star-fill star active"></i>';
        } else if (i === fullStars + 1 && hasHalfStar) {
            stars += '<i class="bi bi-star-half star active"></i>';
        } else {
            stars += '<i class="bi bi-star star"></i>';
        }
    }
    
    return stars;
}

// 2. ÙØ¦Ø© Ø§Ù„ØªÙˆÙØ±
function getAvailabilityClass(percentage) {
    if (percentage < 30) return 'bg-danger';
    if (percentage < 60) return 'bg-warning';
    return 'bg-success';
}

// 3. Ù†Øµ Ø§Ù„ØªÙˆÙØ±
function getAvailabilityText(percentage) {
    if (percentage < 30) return 'Ù…Ø­Ø¯ÙˆØ¯';
    if (percentage < 60) return 'Ù…ØªÙˆØ³Ø·';
    return 'Ù…ØªØ§Ø­';
}

// 4. Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
function showToast(message, type = 'success') {
    const toast = document.createElement('div');
    toast.className = `toast ${type === 'warning' ? 'bg-warning' : type === 'error' ? 'bg-danger' : 'bg-success'}`;
    toast.textContent = message;
    document.body.appendChild(toast);
    
    setTimeout(() => {
        toast.remove();
    }, 4000);
    
    console.log(`ğŸ“¢ ${message}`);
}

// 5. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
function initTheme() {
    const themeToggle = document.getElementById('themeToggle');
    if (!themeToggle) return;
    
    themeToggle.addEventListener('click', function() {
        document.body.classList.toggle('night-mode');
        const icon = this.querySelector('i');
        if (document.body.classList.contains('night-mode')) {
            icon.className = 'bi bi-sun';
            this.title = 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ';
            localStorage.setItem('theme', 'night');
        } else {
            icon.className = 'bi bi-moon';
            this.title = 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ';
            localStorage.setItem('theme', 'light');
        }
    });
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'night') {
        document.body.classList.add('night-mode');
        themeToggle.querySelector('i').className = 'bi bi-sun';
        themeToggle.title = 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ';
    }
}

// 6. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙÙ„Ø§ØªØ±
function setupFilters() {
    const searchInput = document.getElementById('searchStadiums');
    const areaFilter = document.getElementById('areaFilter');
    const priceFilter = document.getElementById('priceFilter');
    
    if (searchInput) {
        searchInput.addEventListener('input', function() {
            filterStadiums();
        });
    }
    
    if (areaFilter) {
        areaFilter.addEventListener('change', filterStadiums);
    }
    
    if (priceFilter) {
        priceFilter.addEventListener('change', filterStadiums);
    }
}

// 7. ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨
function filterStadiums() {
    const searchTerm = document.getElementById('searchStadiums')?.value.toLowerCase() || '';
    const area = document.getElementById('areaFilter')?.value || '';
    const price = document.getElementById('priceFilter')?.value || '';
    
    let filtered = currentStadiums;
    
    // ÙÙ„ØªØ±Ø© Ø¨Ø§Ù„Ø¨Ø­Ø«
    if (searchTerm) {
        filtered = filtered.filter(stadium => 
            stadium.name.toLowerCase().includes(searchTerm) ||
            stadium.location.toLowerCase().includes(searchTerm)
        );
    }
    
    // ÙÙ„ØªØ±Ø© Ø¨Ø§Ù„Ù…Ù†Ø·Ù‚Ø©
    if (area) {
        filtered = filtered.filter(stadium => stadium.area === area);
    }
    
    // ÙÙ„ØªØ±Ø© Ø¨Ø§Ù„Ø³Ø¹Ø±
    if (price) {
        const [min, max] = price.split('-').map(Number);
        filtered = filtered.filter(stadium => {
            if (max === 999) return stadium.price >= min;
            return stadium.price >= min && stadium.price <= max;
        });
    }
    
    renderStadiums(filtered);
    
    if (filtered.length === 0) {
        showToast('âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø¹Ø¨ ØªØ·Ø§Ø¨Ù‚ Ø¨Ø­Ø«Ùƒ', 'warning');
    }
}

// 8. Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠÙ† Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
function initEventListeners() {
    // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„
    window.addEventListener('scroll', function() {
        const navbar = document.querySelector('.navbar');
        if (navbar) {
            if (window.scrollY > 100) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        }
    });
    
    // Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³Ù„Ø³
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
    
    console.log('âœ… ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠÙ†');
}

// ======= ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ =======

// Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ DOM
document.addEventListener('DOMContentLoaded', function() {
    console.log('ğŸ“„ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©');
    initializeApp();
});

// Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Bootstrap
if (typeof bootstrap !== 'undefined') {
    console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Bootstrap');
} else {
    console.error('âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Bootstrap');
}

// Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ÙƒÙˆØ¯ ÙŠØ¹Ù…Ù„
console.log('ğŸ¯ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯ Ø¨Ù†Ø¬Ø§Ø­');
</script>
</body>
</html>

